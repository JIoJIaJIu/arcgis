//>>built
define("dojox/json/ref","dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date/stamp dojox".split(" "),function(F,u,I,A,C,x){A.getObject("json",!0,x);return x.json.ref={resolveJson:function(f,h){function p(d,D,k,a,r,l){var c,B,b;k=q in d?d[q]:k;if(q in d||void 0!==k&&a)k=(t+k).replace(y,"$2$3");a=l||d;if(void 0!==k){x&&(d.__id=k);!h.schemas||d instanceof Array||!(b=k.match(/^(.+\/)[^\.\[]*$/))||(r=h.schemas[b[1]]);if(n[k]&&d instanceof Array==n[k]instanceof Array)a=n[k],delete a.$ref,
delete a._loadObject,B=!0;else if(b=r&&r.prototype)m.prototype=b,a=new m;n[k]=a;v&&(v[k]=h.time)}for(;r;){if(b=r.properties)for(c in d){var z=b[c];z&&"date-time"==z.format&&"string"==typeof d[c]&&(d[c]=C.fromISOString(d[c]))}r=r["extends"]}r=d.length;for(c in d){if(c==r)break;if(d.hasOwnProperty(c)){b=d[c];if("object"==typeof b&&b&&!(b instanceof Date)&&"__parent"!=c)if(g=b[w]||u&&b[q],g&&b.__parent||d==e||(b.__parent=a),g)if(delete d[c],l=g.toString().replace(/(#)([^\.\[])/,"$1.$2").match(/(^([^\[]*\/)?[^#\.\[]*)#?([\.\[].*)?/),
n[(t+g).replace(y,"$2$3")]?g=n[(t+g).replace(y,"$2$3")]:(g="$"==l[1]||"this"==l[1]||""==l[1]?f:n[(t+l[1]).replace(y,"$2$3")])&&l[3]&&l[3].replace(/(\[([^\]]+)\])|(\.?([^\.\[]+))/g,function(a,c,b,d,e){g=g&&g[b?b.replace(/[\"\'\\]/,""):e]}),g)b=g;else{if(!D){var E;E||e.push(a);E=!0;b=p(b,!1,b[w],!0,z);b._loadObject=h.loader}}else D||(b=p(b,e==d,void 0===k?void 0:H(k,c),!1,z,a!=d&&"object"==typeof a[c]&&a[c]));d[c]=b;if(a!=d&&!a.__isDirty&&(l=a[c],a[c]=b,!(!B||b===l||a._loadObject||"_"==c.charAt(0)&&
"_"==c.charAt(1)||"$ref"==c||b instanceof Date&&l instanceof Date&&b.getTime()==l.getTime()||"function"==typeof b&&"function"==typeof l&&b.toString()==l.toString())&&n.onUpdate))n.onUpdate(a,c,l,b)}}if(B&&(q in d||a instanceof Array))for(c in a){if(!(a.__isDirty||!a.hasOwnProperty(c)||d.hasOwnProperty(c)||"_"==c.charAt(0)&&"_"==c.charAt(1)||a instanceof Array&&isNaN(c))){if(n.onUpdate&&"_loadObject"!=c&&"_idAttr"!=c)n.onUpdate(a,c,a[c],void 0);for(delete a[c];a instanceof Array&&a.length&&void 0===
a[a.length-1];)a.length--}}else if(n.onLoad)n.onLoad(a);return a}h=h||{};var q=h.idAttribute||"id",w=this.refAttribute,u=h.idAsRef,t=h.idPrefix||"",x=h.assignAbsoluteIds,n=h.index||{},v=h.timeStamps,g,e=[],y=/^(.*\/)?(\w+:\/\/)|[^\/\.]+\/\.\.\/|^.*\/(\/)/,H=this._addProp,m=function(){};f&&"object"==typeof f&&(f=p(f,!1,h.defaultId,!0),p(e,!1));return f},fromJson:function(f,h){try{var p=eval("("+f+")")}catch(q){throw new SyntaxError("Invalid JSON string: "+q.message+" parsing: "+f);}return p?this.resolveJson(p,
h):p},toJson:function(f,h,p,q){function w(e,f,g){if("object"==typeof e&&e){if(e instanceof Date)return'"'+C.toISOString(e,{zulu:!0})+'"';var m=e.__id;if(m){if("#"!=f&&(A&&!m.match(/#/)||n[m]))return g=m,"#"!=m.charAt(0)&&(g=e.__clientId==m?"cid:"+m:m.substring(0,p.length)==p?m.substring(p.length):m),e={},e[G]=g,u.toJson(e,h);f=m}else e.__id=f,v[f]=e;n[f]=e;g=g||"";var d=h?g+u.toJsonIndentStr:"",q=h?"\n":"",m=h?" ":"";if(e instanceof Array)return"["+F.map(e,function(a,e){var b=w(a,t(f,e),d);"string"!=
typeof b&&(b="undefined");return q+d+b}).join(","+m)+q+g+"]";var k=[],a;for(a in e)if(e.hasOwnProperty(a)){var r;if("number"==typeof a)r='"'+a+'"';else if("string"!=typeof a||"_"==a.charAt(0)&&"_"==a.charAt(1))continue;else r=u._escapeString(a);var l=w(e[a],t(f,a),d);"string"==typeof l&&k.push(q+d+r+":"+m+l)}return"{"+k.join(","+m)+q+g+"}"}return"function"==typeof e&&x.json.ref.serializeFunctions?e.toString():u.toJson(e)}var A=this._useRefs,t=this._addProp,G=this.refAttribute;p=p||"";var n={},v={};
f=w(f,"#","");if(!q)for(var g in v)delete v[g].__id;return f},_addProp:function(f,h){return f+(f.match(/#/)?1==f.length?"":".":"#")+h},refAttribute:"$ref",_useRefs:!1,serializeFunctions:!1}});