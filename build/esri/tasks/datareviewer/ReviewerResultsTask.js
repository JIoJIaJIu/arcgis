//>>built
define("esri/tasks/datareviewer/ReviewerResultsTask","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/json dojo/has ./_DRSBaseTask ../../request ../FeatureSet ../../layers/FeatureEditResult ../../kernel".split(" "),function(p,k,t,l,q,u,v,m,r,w,x){p=p(v,{declaredClass:"esri.tasks.datareviewer.ReviewerResultsTask",constructor:function(){this.onGetResultsComplete=k.hitch(this,this.onGetResultsComplete);this.onWriteResultComplete=k.hitch(this,this.onWriteResultComplete);this.onWriteFeatureAsResultComplete=
k.hitch(this,this.onWriteFeatureAsResultComplete);this.onGetLayerDefinitionComplete=k.hitch(this,this.onGetLayerDefinitionComplete);this.onGetBatchRunDetailsComplete=k.hitch(this,this.onGetBatchRunDetailsComplete)},getResults:function(g,h){var f=this._successHandler,d=this._errorHandler,e=this._appendQueryParams,a=this._url+"/ReviewerResults/getResults",a=e(a),c=new l,e={queryParameters:g.toJSON(),f:"json"};null!==h&&void 0!==h&&(e.filtersArray=h.toJSON());return m({callbackParamName:"callback",url:a,
content:e}).then(k.hitch(this,function(b){if(void 0!==b.error){var a=Error();return a.message=b.error.message,a.code=b.error.code,void d(a,c)}try{void 0===b.features||void 0===b.fieldAliases||void 0===b.fields?d(null,c):(a=new r(b),f({featureSet:a},"onGetResultsComplete",c))}catch(e){d(e,c)}}),function(b){d(b,c)}),c},writeResult:function(g,h){var f=this._successHandler,d=this._errorHandler,e=this._appendQueryParams,a=this._url+"/ReviewerResults/writeResult",a=e(a),c=new l;return m({callbackParamName:"callback",
url:a,content:{reviewerAttributes:g.toJSON(),geometry:q.stringify(h.toJson()),f:"json"}}).then(k.hitch(this,function(b){var a=Error();if(void 0!==b.error)return a.message=b.error.message,a.code=b.error.code,void d(a,c);try{void 0!==b.result&&"error"===b.result?(a.message=b.messages,a.code=b.result,d(a,c)):"success"===b.result?f({success:!0},"onWriteResultComplete",c):d(null,c)}catch(e){d(e,c)}}),function(b){d(b,c)}),c},writeFeatureAsResult:function(g,h){var f=this._successHandler,d=this._errorHandler,
e=this._appendQueryParams,a=this._url+"/ReviewerResults/writeFeatureAsResult",a=e(a),c=new l;return m({callbackParamName:"callback",url:a,content:{reviewerAttributes:g.toJSON(),feature:q.stringify(h.toJson()),f:"json"}}).then(k.hitch(this,function(b){var a=Error();if(void 0!==b.error)return a.message=b.error.message,a.code=b.error.code,void d(a,c);try{void 0!==b.result&&"error"===b.result?(a.message=b.messages,a.code=b.result,d(a,c)):"success"===b.result?f({success:!0},"onWriteFeatureAsResultComplete",
c):d(null,c)}catch(e){d(e,c)}}),function(a){d(a,c)}),c},getLayerDefinition:function(g){var h=this._successHandler,f=this._errorHandler,d=this._appendQueryParams,e=this._url+"/ReviewerResults/getLayerDefinition",e=d(e),a=new l,d={f:"json"};null===g&&void 0===g||(d.filtersArray=g.toJSON());return m({callbackParamName:"callback",url:e,content:d}).then(k.hitch(this,function(c){if(void 0!==c.error){var b=Error();return b.message=c.error.message,b.code=c.error.code,void f(b,a)}try{void 0===c.whereClause?
f(null,a):h({whereClause:c.whereClause},"onGetLayerDefinitionComplete",a)}catch(d){f(d,a)}}),function(c){f(c,a)}),a},getBatchRunDetails:function(g){var h=this._successHandler,f=this._errorHandler,d=this._appendQueryParams,e=this._url+"/ReviewerResults/getBatchRunDetails",e=d(e),a=new l;return m({callbackParamName:"callback",url:e,content:{batchRunIds:q.stringify(g),f:"json"}}).then(k.hitch(this,function(c){if(void 0!==c.error){var b=Error();return b.message=c.error.message,b.code=c.error.code,void f(b,
a)}try{void 0===c.features||void 0===c.fieldAliases||void 0===c.fields?f(null,a):(b=new r(c),h({featureSet:b},"onGetBatchRunDetailsComplete",a))}catch(d){f(d,a)}}),function(c){f(c,a)}),a},updateLifecycleStatus:function(g,h,f,d){var e=this._successHandler,a=this._errorHandler,c=this._appendQueryParams,b=this._url+"/ReviewerResults/updateLifecycleStatus",b=c(b),n=new l;return m({callbackParamName:"callback",url:b,content:{sessionId:g,lifecycleStatus:h,technicianName:f,filtersArray:d.toJSON(),f:"json"}}).then(k.hitch(this,
function(b){if(void 0!==b.error){var c=Error();return c.message=b.error.message,c.code=b.error.code,void a(c,n)}try{var d=[];t.forEach(b.updateResults,function(a){var b=new w;b.error=Error(a.description);b.success=a.success;b.objectId=a.objectId;d.push(b)});e({featureEditResults:d},"onUpdateLifecycleStatusComplete",n)}catch(f){a(f,n)}}),function(b){a(b,n)}),n},getResultsFieldNames:function(){return"recordId objectId subtype category sessionId checktitle resourceName checkName notes severity reviewStatus correctionStatus verificationStatus reviewTechnician correctionTechnician verificationTechnician reviewDateUtc correctionDateUtc verificationDateUtc lifecycleStatus".split(" ")},
onGetResultsComplete:function(){},onWriteResultComplete:function(){},onWriteFeatureAsResultComplete:function(){},onGetLayerDefinitionComplete:function(){},onGetBatchRunDetailsComplete:function(){},onUpdateLifecycleStatusComplete:function(){}});return u("extend-esri")&&k.setObject("tasks.datareviewer.ReviewerResultsTask",p,x),p});