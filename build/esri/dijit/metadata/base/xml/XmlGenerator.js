//>>built
define("esri/dijit/metadata/base/xml/XmlGenerator","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ./xmlUtil ../../../../kernel".split(" "),function(k,n,p,y,u,z){k=k(null,{nl:"\r\n",tb:"\t",xmlHeader:'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e',constructor:function(a){n.mixin(this,a)},generate:function(a,b,d,c){a={gxeDocument:a,transformer:c};b=this._collect(b,null,{ignoreOptionallyOff:!1,validationTracker:d});b=this._walk(b,!0,a);return d&&d.whenComplete(),b},_checkTarget:function(a,
b,d){var c,f="",g="";b=b.widget;var e=b.target;a.transformer&&(e=a.transformer.checkTarget(b,e));a=[e];return b.inputWidget&&b.inputWidget.subTarget&&(c=n.trim(b.inputWidget.subTarget),0<c.length&&(a.push(c),e=c,f=d+"\x3c"+a[0]+"\x3e",g=d+"\x3c/"+a[0]+"\x3e")),{aNames:a,sBegin:f,sEnd:g,sName:e}},_collect:function(a,b,d){if(a.ignoreContent)return null;var c,f,g=!1,e=!1;return a._isGxeElement?(e=a._isOptionallyOff,a.multiplicityHeader&&a.multiplicityHeader.useTabs&&(e=a.multiplicityHeader._isOptionallyOff)):
e=a._isOptionallyOff,a._isGxeElement?(d.ignoreOptionallyOff||!e)&&(f={isAttribute:!1,widget:a,depth:0,xvalue:null,serialize:a.serialize,references:[],attributeRefs:[],elementRefs:[]},f.xvalue=a.checkXmlValue(),a.isDocumentTitle&&(d.validationTracker.documentTitle=f.xvalue),a.validateValue(d.validationTracker),b&&(f.depth=b.depth+1,b.references.push(f),b.elementRefs.push(f)),b=f,g=!0):a._isGxeAttribute?(d.ignoreOptionallyOff||!e)&&(c={isAttribute:!0,widget:a,xvalue:null,serialize:a.serialize},c.xvalue=
a.checkXmlValue(),a.isDocumentTitle&&(d.validationTracker.documentTitle=c.xvalue),a.validateValue(d.validationTracker),b&&(b.references.push(c),b.attributeRefs.push(c),c.serialize&&a.isIsoCodeListValue?(b.xvalue=c.xvalue,null===c.xvalue&&(b.serialize=!1)):!c.serialize&&a.isIsoCodeListValue&&(b.serialize=!1))):(d.ignoreOptionallyOff||!e)&&(g=!0),g&&(p.forEach(a.getChildren(),function(a){this._collect(a,b,d)},this),a.validateConditionals&&a.validateConditionals(d.validationTracker)),b},_renderNamespaces:function(a,
b,d,c){if(!b)return a;b=d.getNamespaces();return c.transformer&&(b=c.transformer.toDocumentType.getNamespaces()),p.forEach(b,function(b){b.prefix&&b.uri&&(a+=" xmlns:"+b.prefix+'\x3d"'+b.uri+'"')}),a},_walk:function(a,b,d){if(!a.serialize)return"";var c,f,g=function(a,b,c,d,e,f,g){var h=null;return"TopicCatCd@value"===c?a+d+"\x3cTopicCatCd value\x3d'"+f+"'/\x3e"+b:(h=d+"\x3c"+c+e,0===f.length&&0===g.length?h+="/\x3e":(h+="\x3e",0<f.length&&(h+=f),0<g.length&&(h+=g+d),h+="\x3c/"+c+"\x3e"),a+h+b)},
e="",q="",l=this.nl,k="",r=[];for(c=0;c<a.depth;c++)l+=this.tb;b&&(e=this._renderNamespaces(e,b,d.gxeDocument,d));a.serialize&&null!==a.xvalue&&(a.xvalue.push?p.forEach(a.xvalue,function(a){r.push(u.escape(a))},this):k=u.escape(a.xvalue));p.forEach(a.attributeRefs,function(a){a.serialize&&null!==a.xvalue&&(f=u.escape(a.xvalue),e+=" "+a.widget.target.replace("@","")+'\x3d"'+f+'"')},this);p.forEach(a.elementRefs,function(a){a=this._walk(a,!1,d);null!==a&&0<a.length&&(q+=a)},this);var n=0===e.length&&
0===k.length&&0===r.length&&0===q.length;if(n&&!a.widget.serializeIfEmpty)return null;var t=this._checkTarget(d,a,l),v=t.sBegin,w=t.sEnd,x=t.sName;for(c=0;c<t.aNames.length-1;c++)l+=this.tb;var m=null;return n&&a.widget.serializeIfEmpty?m=v+l+"\x3c"+x+"/\x3e"+w:0===r.length?m=g(v,w,x,l,e,k,q):(m="",p.forEach(r,function(a){m+=g(v,w,x,l,e,a,q)})),b&&(m=this.xmlHeader+m),m}});return y("extend-esri")&&n.setObject("dijit.metadata.base.xml.XmlGenerator",k,z),k});