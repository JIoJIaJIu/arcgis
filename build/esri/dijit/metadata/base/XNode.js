//>>built
define("esri/dijit/metadata/base/XNode","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dojo/dom-attr dojo/has ./etc/docUtil ./etc/validationUtil ./Templated ../../../kernel".split(" "),function(f,e,g,h,l,m,n,k,p,q){f=f([p],{_isGxeAttribute:!1,_isGxeElement:!1,_isGxeNode:!0,_isOptionallyOff:!1,conditionalValidator:null,gxeDocument:null,gxePath:null,inputWidget:null,parentElement:null,notApplicable:!1,serialize:!0,label:null,target:null,fixed:!1,isDocumentTitle:!1,optionsFilter:null,
serializeIfEmpty:!1,trim:!0,value:null,valueType:null,alternateValues:null,postCreate:function(){this.inherited(arguments)},destroy:function(){try{var a=this.conditionalValidator;a&&(e.isArray(a)?g.forEach(a,function(a){a.destroyRecursive(!1)}):a.destroyRecursive(!1))}catch(b){console.error(b)}try{h.publish("gxe/xnode-destroyed",{xnode:this})}catch(c){console.error(c)}this.inherited(arguments);try{h.publish("gxe/after-xnode-destroyed",{xnode:this})}catch(d){console.error(d)}},afterValidateValue:function(){},
beforeValidateValue:function(){},buildPath:function(){var a=function(a,b,c){b._isGxeRootDescriptor&&b.gxeDocument&&(a.gxeDocument||(a.gxeDocument=b.gxeDocument),!a.gxeDocument.rootElement&&c&&(a.gxeDocument.rootElement=c))};"string"!=typeof this.target&&(this.target=null);null!==this.target&&(this.target=e.trim(this.target),0===this.target.length&&(this.target=null));var b=null,c=this.getParent(),d=this.target;this._isGxeAttribute&&(d="@"+d);this._isGxeElement&&(b=this);for(this._isGxeElement&&a(this,
this,b);c;){if(c._isGxeElement){if(this.parentElement||(this.parentElement=c),null!==c.gxePath&&null!==c.gxeDocument)return this.gxePath=c.gxePath+"/"+d,this.gxeDocument=c.gxeDocument,l.set(this.domNode,"data-gxe-path",this.gxePath),void this._validateTarget();d=c.target+"/"+d;b=c}a(this,c,b);c=c.getParent()}this.gxePath="/"+d;l.set(this.domNode,"data-gxe-path",this.gxePath);this._validateTarget()},_checkOccurs:function(a,b){var c=1,d=typeof b;if(this._isGxeAttribute){if(a)return 1;c=0}if("undefined"!==
d&&null!==b){if("string"===d){if(b=e.trim(b).toLowerCase(),a&&"unbounded"===b)return b;0<b.length&&(b=parseInt(b,10),isNaN(b)||(d=typeof b))}"number"===d&&isFinite(b)&&(0>b&&(b=0),c=b)}return c},checkXmlValue:function(){var a=this.getXmlValue();return"undefined"==typeof a&&(a=null),null!==a&&(this.trim&&"string"==typeof a&&(a=e.trim(a)),a.push||(a=""+a),this.serializeIfEmpty||0!==a.length||(a=null)),a},findInputWidget:function(){var a=null;return g.some(this.getChildren(),function(b){return b._isGxeInput?
(a=b,!0):void 0}),a},getLabelString:function(){var a,b=this.label;return"undefined"!=typeof b&&null!=b?b:(a=this.target,"undefined"!=typeof a&&null!=a?(this.label=a,a):"No Target")},getParentElement:function(){for(var a=this.getParent();a;){if(a._isGxeElement)return a;a=a.getParent()}return null},getXmlValue:function(){return this.inputWidget?this.inputWidget.getXmlValue():this.value},getValidationLabel:function(){return!this.showHeader&&this.parentElement?this._isGxeElement&&this._adoptedForMultiplicity?
this.getLabelString():this.parentElement.getValidationLabel():this.getLabelString()},isLineageDescendant:function(a){var b=this;if(0===b.gxePath.indexOf(a.gxePath))for(;b;){if(b===a)return!0;b=b.parentElement}return!1},_newValidationStatus:function(){return{isValid:!0,isRequired:!1,label:null,message:"",xnodeWidget:this,inputWidget:this.inputWidget}},_publishStarted:function(){try{h.publish("gxe/xnode-started",{xnode:this})}catch(a){console.error(a)}},resolveMinOccurs:function(){return this.minOccurs},
_validateTarget:function(){var a,b=function(a,b){console.log("*** ",b);var c=n.findDescriptor(a);c&&c.templateString&&(console.log(c.templateString),console.log(c))},c=this.target;if(this.minOccurs=this._checkOccurs(!1,this.minOccurs),this.maxOccurs=this._checkOccurs(!0,this.maxOccurs),!this.gxeDocument)throw Error("XNode.validateTarget: Unable to connect to gxeDocument "+this.target);if("string"!=typeof c||null===c||0===c.length)throw a="XNode.validateTarget: The target is empty: "+this.target,b(this,
a),Error(a);if(-1!==this.target.indexOf("/"))throw a="XNode.validateTarget: The target should not contain a forward slash: "+this.target,b(this,a),Error(a);this._isGxeElement&&-1===this.target.indexOf(":")&&this.gxeDocument.hasNamespaces()&&(a="XNode.validateTarget: The target has no namespace prefix: "+this.target,b(this,a))},validateConditionals:function(a){var b=this.conditionalValidator;b&&(e.isArray(b)?g.forEach(b,function(b){b.validateConditionals(a)}):b.validateConditionals(a))},validateValue:function(a){var b=
this._newValidationStatus();if(this.fixed||!this.inputWidget)return b;var c=this.resolveMinOccurs();b.isRequired=0<c;b.label=this.getValidationLabel();c=this.inputWidget.getInputValue();"undefined"==typeof c&&(c=null);null!==c&&this.trim&&"string"==typeof c&&(c=e.trim(c));this.beforeValidateValue(k,b,c);b.isValid&&k.validateValue(b,c);this.afterValidateValue(k,b,c);if(c=!b.isValid&&a){for(var c=!1,d=this;d;){if(d.notApplicable){c=!0;break}d=d.parentElement}c=c?!1:!0}return c&&a.handleValidationError(this,
b.message,this.inputWidget),b}});return m("extend-esri")&&e.setObject("dijit.metadata.base.XNode",f,q),f});