//>>built
require({cache:{"url:esri/dijit/templates/MultidimensionalSlider_vertical.html":'\x3cdiv class\x3d"esriMdSliderVertical"\x3e\n  \x3ctable class\x3d"esriMdSliderTableVertical" data-dojo-attach-point\x3d"mdSliderTable"\x3e\n    \x3ctr\x3e\n      \x3ctd class\x3d"esriMdSliderDimensionInfoCellVertical" align\x3d"middle"\x3e\n        \x3cdiv data-dojo-attach-point\x3d"dimensionInfo" class\x3d"esriMdSliderDimensionInfo"\x3e\n          \x3cbr/\x3e\x3cbr/\x3e\x3cbr/\x3e\n        \x3c/div\x3e\n      \x3c/td\x3e\n    \x3c/tr\x3e\n    \x3ctr\x3e\n      \x3ctd class\x3d"esriMdSliderCellVertical" data-dojo-attach-point\x3d"mdSliderCell"\x3e\x3c/td\x3e\n    \x3c/tr\x3e\n    \x3ctr  class\x3d"esriMdsSliderPlayButtonRow"  data-dojo-attach-point\x3d"playPauseBtnRow"\x3e\n      \x3ctd align\x3d"middle" valign\x3d"middle" class\x3d"esriMdsSliderPlayButtonCell"\x3e\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'mdsButton mdsPlayButton\'" data-dojo-attach-event\x3d"onClick:_onPlay" data-dojo-attach-point\x3d"playPauseBtn" type\x3d"button"\n                title\x3d"${_i18n.widgets.mdSlider.NLS_play}"\x3e\n        \x3c/button\x3e\x3c/td\x3e\n    \x3c/tr\x3e\n  \x3c/table\x3e\n\x3c/div\x3e\n',
"url:esri/dijit/templates/MultidimensionalSlider_horizontal.html":'\x3cdiv class\x3d"esriMdSliderHorizontal"\x3e\n  \x3ctable class\x3d"esriMdSliderTableHorizontal"\x3e\n    \x3ccolgroup\x3e\n      \x3ccol class\x3d"esriMdSliderHorizontalCol1"\x3e\n      \x3ccol\x3e\n    \x3c/colgroup\x3e\n    \x3ctr\x3e\n      \x3ctd class\x3d"esriMdSliderDimensionInfoCellHorizontal" colspan\x3d"2"\x3e\n        \x3cdiv data-dojo-attach-point\x3d"dimensionInfo"\x3e\x3c/div\x3e\n      \x3c/td\x3e\n    \x3c/tr\x3e\n    \x3ctr\x3e\n      \x3ctd align\x3d"right" valign\x3d"middle"\x3e\x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'mdsButton mdsPlayButton\'" data-dojo-attach-event\x3d"onClick:_onPlay" \n                                               data-dojo-attach-point\x3d"playPauseBtn" type\x3d"button" title\x3d"${_i18n.widgets.mdSlider.NLS_play}"\x3e\x3c/button\x3e\x3c/td\x3e\n      \x3ctd class\x3d"esriMdSliderCellHorizontal" data-dojo-attach-point\x3d"mdSliderCell"\x3e\n      \x3c/td\x3e\n    \x3c/tr\x3e\n  \x3c/table\x3e\n\x3c/div\x3e\n'}});
define("esri/dijit/MultidimensionalSlider","dojo/_base/declare dojo/_base/lang dojo/has dojo/on dojo/json dijit/form/VerticalSlider dojox/form/VerticalRangeSlider dijit/form/VerticalRule dijit/form/VerticalRuleLabels dijit/form/HorizontalSlider dojox/form/HorizontalRangeSlider dijit/form/HorizontalRule dijit/form/HorizontalRuleLabels dijit/_Widget dijit/_Templated dojox/timing/_base dojo/_base/array dojo/Deferred dojo/DeferredList ../layers/MosaicRule ../layers/DimensionalDefinition ../kernel ../lang ./_EventedWidget dojo/text!./templates/MultidimensionalSlider_vertical.html dojo/text!./templates/MultidimensionalSlider_horizontal.html dojo/i18n!../nls/jsapi dojo/dom-class dojo/dom-style dojo/dom-geometry".split(" "),
function(t,g,u,v,q,y,z,A,B,C,D,E,F,p,G,H,e,I,J,K,L,M,h,N,O,P,Q,w,m,x){var k={LAYOUT_VERTICAL:"vertical",LAYOUT_HORIZONTAL:"horizontal"};p=t([N,p,G],{declaredClass:"esri.dijit.MultidimensionalSlider",widgetsInTemplate:!0,templateString:O,nLabels:10,_thumbCount:1,useRanges:!1,loop:!0,useLayersDimSlices:!0,prefetch:!0,prefetchedValues:{},showPlayButton:!0,prefetchFactor:2,_hasUnitConflict:!1,_update:!0,playDirectionAscending:!0,unitSymbols:{meter:"m",pascal:"Pa"},_eventMap:{"dimension-value-change":!0,
play:!0,pause:!0,next:!0,previous:!0,change:!0,"dimension-array-create":!0},onChange:function(){},onPlay:function(){},onPause:function(){},onDimensionValueChange:function(){},_onPlay:function(){this.playing=!this.playing;this._updateUI();this.playing?(this._timer.start(),this.onPlay()):(this._timer.stop(),this.onPause())},constructor:function(a){t.safeMixin(this,a);this.playing=!1;this._iconClass="mdsButton mdsPlayButton";this.map&&this._getImageLayers();this.layout===k.LAYOUT_HORIZONTAL&&(this.templateString=
P);this.thumbMovingRate=this.thumbMovingRate||3E3;this._i18n=Q;this.prefetchImgNodes={}},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);var a=this;this._getAllLayersMDInfo().then(function(){a._sortDimensionValues();a.dimensionValues=a.dimensionValues&&a.dimensionValues.length&&!a.useLayersDimValues?a.dimensionValues:a._mapSortedDimensionValues;a.getUnit();a._setupSlider(!0)});this.showPlayButton?m.set(this.playPauseBtn.domNode,"display","block"):(m.set(this.playPauseBtn.domNode,
"display","none"),this.playPauseBtnRow&&m.set(this.playPauseBtnRow,"display","none"));this._timer=new H.Timer;this._timer.setInterval(this.thumbMovingRate);this._timer.onTick=g.hitch(this,function(){this._bumpSlider(this.playDirectionAscending?1:-1)});this.layout===k.LAYOUT_VERTICAL&&(this.computeSliderStyle(),this.on("resize",g.hitch(this,"computeSliderStyle")))},increment:function(){var a=1;!this.playDirectionAscending&&this.playing&&(a=-1);this._bumpSlider(a)},decrement:function(){var a=-1;!this.playDirectionAscending&&
this.playing&&(a=1);this._bumpSlider(a)},_setDimensionAttr:function(a){var b=h.isDefined(b)?!1:!0;this._slider&&(a.dimension&&(this.dimension=a.dimension),this.dimensionValues=a.dimensionValues&&a.dimensionValues.length?a.dimensionValues:[],this.update(!1))},update:function(a){var b=this;this._mapSortedDimensionValues=[];this._getImageLayers();this.value=a?this.dimensionValues[this._slider.value]:null;this._getAllLayersMDInfo().then(function(){b._sortDimensionValues();b.getUnit();b.dimensionValues&&
b.dimensionValues.length&&!b.useLayersDimSlices||(b.dimensionValues=b._mapSortedDimensionValues);b._setupSlider(a)})},pause:function(){this.playing=!1;this._updateUI();this._timer.stop()},play:function(a){!0!==this.playing&&(this.playing=!1,this._onPlay())},_setupSlider:function(a){this._destroySlider();this.dimensionValues&&this.dimensionValues.length&&(this.sliderNode=document.createElement("div"),this._getDimensionAlias(),this._layers&&this._layers.length&&1===this._layers.length&&a&&this._readMosaicRule(),
this._createRule(),this._createLabels(),this._createSlider(),this._slider.onChange(this._slider.value))},_createLabels:function(){this.layout===k.LAYOUT_HORIZONTAL?this._createHorizontalLabels():this._createVerticalLabels()},_createRule:function(){this.layout===k.LAYOUT_HORIZONTAL?this._createHorizontalRule():this._createVerticalRule()},_createVerticalLabels:function(){this.labelsNode=document.createElement("div");this.sliderNode.appendChild(this.labelsNode);this._sliderLabels=new B({labels:this._filterLabels(),
labelStyle:"font-size: 83%; padding-left: 5px;"},this.labelsNode)},_createVerticalRule:function(){this.rulesNode=document.createElement("div");this.sliderNode.appendChild(this.rulesNode);100>=this.dimensionValues.length&&(this._sliderRules=new A({count:this.dimensionValues.length,style:"width:5px;"},this.rulesNode),this._sliderRules.startup())},_createHorizontalLabels:function(){this.labelsNode=document.createElement("div");this.sliderNode.appendChild(this.labelsNode);this._sliderLabels=new F({labels:this._filterLabels(),
labelStyle:"font-size: 83%"},this.labelsNode)},_createHorizontalRule:function(){this.rulesNode=document.createElement("div");this.sliderNode.appendChild(this.rulesNode);100>=this.dimensionValues.length&&(this._sliderRules=new E({count:this.dimensionValues.length,style:"height:5px;"},this.rulesNode),this._sliderRules.startup())},_createHorizontalSingleSlider:function(a){a=a?a:this.playDirectionAscending?0:this.dimensionValues.length-1;this._slider=new C({name:"horizontal",minimum:0,maximum:this.dimensionValues.length-
1,intermediateChanges:!1,discreteValues:this.dimensionValues.length,style:"width: 100%;",increment:g.hitch(this,"increment"),decrement:g.hitch(this,"decrement"),value:a||0,onChange:g.hitch(this,this._onSingleSliderChange),showButtons:this.showPlayButton},this.sliderNode);this._slider.startup()},_createHorizontalRangeSlider:function(a){a=a?a:this.playDirectionAscending?[0,1]:[this.dimensionValues.length-2,this.dimensionValues.length-1];this._slider=new D({name:"horizontal",minimum:0,maximum:this.dimensionValues.length-
1,intermediateChanges:!1,discreteValues:this.dimensionValues.length,style:"width:100%;",increment:g.hitch(this,"increment"),decrement:g.hitch(this,"decrement"),value:a||[0,1],onChange:g.hitch(this,this._onRangeSliderChange),showButtons:this.showPlayButton},this.sliderNode);this._slider.startup();v(this._slider.incrementButton,"click",this._slider.increment);v(this._slider.decrementButton,"click",this._slider.decrement);this._slider._typematicCallback=function(){}},_createVerticalSingleSlider:function(a){a=
a?a:this.playDirectionAscending?0:this.dimensionValues.length-1;this._slider=new y({name:"vertical",minimum:0,maximum:this.dimensionValues.length-1,intermediateChanges:!1,discreteValues:this.dimensionValues.length,style:this.computeSliderStyle(),increment:g.hitch(this,"increment"),decrement:g.hitch(this,"decrement"),value:a||0,onChange:g.hitch(this,this._onSingleSliderChange),showButtons:this.showPlayButton},this.sliderNode);this._slider.startup()},_createVerticalRangeSlider:function(a){a=a?a:this.playDirectionAscending?
[0,1]:[this.dimensionValues.length-2,this.dimensionValues.length-1];this._slider=new z({name:"vertical",minimum:0,maximum:this.dimensionValues.length-1,intermediateChanges:!1,discreteValues:this.dimensionValues.length,style:this.computeSliderStyle(),increment:g.hitch(this,"increment"),decrement:g.hitch(this,"decrement"),value:a||[0,1],onChange:g.hitch(this,this._onRangeSliderChange),showButtons:this.showPlayButton},this.sliderNode);this._slider.startup();this._slider._typematicCallback=function(){}},
_onSingleSliderChange:function(a){var b=this.dimensionValues[a];this.setDimensionInfoText(b);e.forEach(this._layers,function(c){this._updateMosaicRule(c,b);this.prefetch&&this.playing&&this._prefetchData(a,c)},this);this._oldValue=a;this.value=b;this.onChange(b)},_onRangeSliderChange:function(a){if(this._update){this._snap&&(a=this._snapToNearestRange(a));var b=[this.dimensionValues[a[1]],this.dimensionValues[a[0]]];b.sort(this._sortCompareFunction);this.value=b;this.setDimensionInfoText(b);e.forEach(this._layers,
function(c){this._updateMosaicRule(c,b);this.prefetch&&this.playing&&this._prefetchData(a,c)},this);this._update=!0;this._oldValue=g.clone(a);this.onChange(b)}},destroy:function(){this.inherited(arguments);this._timer.stop()},_destroySlider:function(){this._slider&&(this._slider.destroy(),this._slider=null)},_createSlider:function(){var a;this.mdSliderCell.appendChild(this.sliderNode);this.value&&this.value.length?a=0<=e.indexOf(this.dimensionValues,this.value[0])&&0<=e.indexOf(this.dimensionValues,
this.value[1])?[e.indexOf(this.dimensionValues,this.value[0]),e.indexOf(this.dimensionValues,this.value[1])]:[0,1]:this.value&&(a=0<=e.indexOf(this.dimensionValues,this.value)?e.indexOf(this.dimensionValues,this.value):0);2===this._thumbCount?this.layout===k.LAYOUT_HORIZONTAL?this._createHorizontalRangeSlider(a):this._createVerticalRangeSlider(a):this.layout===k.LAYOUT_HORIZONTAL?this._createHorizontalSingleSlider(a):this._createVerticalSingleSlider(a)},_getMultidimensionalInfo:function(a){function b(){a.getMultidimensionalInfo().then(function(b){a.multidimensionalInfo=
b;c.resolve(a)},function(a){c.reject(a)})}var c=new I;return a.multidimensionalInfo?c.resolve(a):a.loaded?b():a.on("load",function(){b()}),c},_getAllLayersMDInfo:function(){var a=[];e.forEach(this._layers,function(b){a.push(this._getMultidimensionalInfo(b))},this);return new J(a)},_getImageLayers:function(){var a,b=this.map.layerIds.concat(this.map.graphicsLayerIds);return this._layers=[],e.forEach(b,function(b){a=this.map.getLayer(b);"esri.layers.ArcGISImageServiceLayer"!==a.declaredClass&&"esri.layers.ArcGISImageServiceVectorLayer"!==
a.declaredClass&&"esri.layers.RasterLayer"!==a.declaredClass||this._layers.push(a)},this),this._layers},_sortCompareFunction:function(a,b){return h.isDefined(a)&&h.isDefined(b)?a-b:!1},_getDimensionObjects:function(){function a(a){if(a&&a.values&&a.hasRanges){var d=[];e.forEach(a.values,function(a){a.length?d=b(d.sort(this._sortCompareFunction),a):d.push.apply(b(d.sort(this._sortCompareFunction),[a]))},this);a.decodedValues=d}return a}var b=this._merge;this._allRangeValues=!0;this._thumbCount=1;this._snap=
!1;this._dimensionObjects=[];this._layers=this._filterLayers();e.forEach(this._layers,function(a){a.multidimensionalInfo&&e.some(a.multidimensionalInfo.variables,function(a){e.some(a.dimensions,function(a){return a.name!==this.dimension||a.hasRanges?void 0:void(this._allRangeValues=!1)},this)},this)},this);this.useRanges?(this._thumbCount=2,this._snap=!1):this._allRangeValues&&this.useLayersDimSlices?(this._thumbCount=2,this._snap=!0):this._snap=!1;e.forEach(this._layers,function(b){b.multidimensionalInfo&&
e.some(b.multidimensionalInfo.variables,function(b){e.some(b.dimensions,function(b){b.name===this.dimension&&(this._allRangeValues&&b.hasRanges||this.useRanges?this._dimensionObjects.push(a(g.clone(b))):!this._allRangeValues&&b.hasRanges||this._dimensionObjects.push(g.clone(b)))},this)},this)},this)},_merge:function(a,b){for(var c=[],d=0,f=0;d<a.length&&f<b.length;)a[d]<b[f]?c.push(a[d++]):a[d]>b[f]?c.push(b[f++]):(c.push(b[f++]),d++);return c=c.concat(a.slice(d)).concat(b.slice(f)),c=e.filter(c,
function(a,b,c){return c.indexOf(a)===b})},_mergeRangeArrays:function(a,b){for(var c=[],d=0,f=0;d<a.length&&f<b.length;)a[d][0]<b[f][0]||a[d][0]===b[f][0]&&a[d][1]<b[f][1]?c.push(a[d++]):a[d][0]>b[f][0]||a[d][0]===b[f][0]&&a[d][1]>b[f][1]?c.push(b[f++]):(c.push(b[f++]),d++);return c=c.concat(a.slice(d)).concat(b.slice(f)),c=e.filter(c,function(a,b,c){return c.indexOf(a)===b},this)},_sortDimensionValues:function(){var a=0,b=this._merge,c=this._mergeRangeArrays;if(this._getDimensionObjects(),1<=this._dimensionObjects.length&&
(this._mapSortedDimensionValues=this._dimensionObjects[0].decodedValues||this._dimensionObjects[0].values,this._allRangeValues&&(this._dimensionRangeValues=this._dimensionObjects[0].values)),1<this._dimensionObjects.length)for(a=1;a<this._dimensionObjects.length;a++)this._mapSortedDimensionValues=b(this._mapSortedDimensionValues,this._dimensionObjects[a].decodedValues||this._dimensionObjects[a].values),this._allRangeValues&&(this._dimensionRangeValues=c(this._dimensionRangeValues,this._dimensionObjects[a].values))},
_createDimensionalDefinition:function(a,b){var c=[a];return new L({variableName:b,dimensionName:this.dimension,values:c,isSlice:1===c.length})},_updateMosaicRule:function(a,b){var c=!1,d=a.mosaicRule||a.defaultMosaicRule||new K({multidimensionalDefinition:[]}),f=d.multidimensionalDefinition||[];b.length&&b.sort(this._sortCompareFunction);e.forEach(f,function(a){a.dimensionName===this.dimension&&(a.values=[b],a.isSlice=!this.useRanges,c=!0)},this);c||e.some(a.multidimensionalInfo.variables,function(a){return e.some(a.dimensions,
function(a){return a.name===this.dimension?!0:void 0},this)?!0:void 0},this)&&(f.push(this._createDimensionalDefinition(b,"")),c=!0);c&&(d.multidimensionalDefinition=f,a.setMosaicRule(d))},_prefetchData:function(a,b){if(b&&b.mosaicRule){var c,d,f,l,r,n=!1,h=this;this.prefetchedValues[b.id]||(this.prefetchedValues[b.id]=[]);this.prefetchImgNodes[b.id]=[];d=g.clone(b._params);f=g.clone(b.mosaicRule);for(c=1;c<=this.prefetchFactor;c++)n=!1,e.forEach(f.multidimensionalDefinition,function(d){d.dimensionName===
this.dimension&&(this.playDirectionAscending?a.length?(this.snap?(l=this._getNextRangeIndex(a)||a,d.values=[this.dimensionValues[l[0]],this.dimensionValues[l[1]]]):d.values=[this.dimensionValues[(a[0]+c)%this.dimensionValues.length],this.dimensionValues[(a[1]+c)%this.dimensionValues.length]],d.values.sort(this._sortCompareFunction)):d.values=[this.dimensionValues[(a+c)%this.dimensionValues.length]]:a.length?(this.snap?(l=this._getNextRangeIndex(a,-1)||a,d.values=[this.dimensionValues[l[0]],this.dimensionValues[l[1]]]):
d.values=[this.dimensionValues[(this.dimensionValues.length+a[0]-c)%this.dimensionValues.length],this.dimensionValues[(this.dimensionValues.length+a[1]-c)%this.dimensionValues.length]],d.values.sort(this._sortCompareFunction)):d.values=[this.dimensionValues[(this.dimensionValues.length+a-c)%this.dimensionValues.length]],e.some(this.prefetchedValues[b.id],function(a){return q.stringify(a)===q.stringify(d.values)?!0:void 0})||(n=!0,this.prefetchedValues[b.id].push(d.values)))},this),n&&(d.mosaicRule=
q.stringify(f.toJson()),b.getImageUrl(this.map.extent,this.map.width,this.map.height,function(a){r=new Image;h.prefetchImgNodes[b.id].push(r);r.src=a},d))}},setDimensionInfoText:function(a){if(h.isDefined(a)){var b=this.unitSymbol||this.unit;"number"!=typeof a?(a=g.clone(a.sort(this._sortCompareFunction)),(0!==a[0]%1||0!==a[1]%1)&&(a[0]=parseFloat(a[0].toFixed(2)),a[1]=parseFloat(a[1].toFixed(2))),a="["+a[0]+", "+a[1]+"]"):0!==a%1&&(a=a.toFixed(2));this.dimensionInfo.innerHTML=this.unitSymbol?"\x3clabel style\x3d'font-weight:700;'\x3e"+
this.dimensionAlias+" ("+b+")\x3c/label\x3e":"\x3clabel style\x3d'font-weight:700;'\x3e"+this.dimensionAlias+"\x3c/label\x3e";this.dimensionInfo.innerHTML+=this.layout===k.LAYOUT_HORIZONTAL?": "+a:"\x3cbr/\x3e "+a}},setLabels:function(){},_filterLabels:function(){if(this.nLabels&&this.dimensionValues&&this.dimensionValues.length){var a=Math.ceil(this.dimensionValues.length/this.nLabels);return e.map(this.dimensionValues,function(b,c){return 0===c%a||c===this.dimensionValues.length-1?(0!==b%1&&(b=
parseFloat(b.toFixed(2))),b):""},this)}},_filterLayers:function(){return e.filter(this._layers,function(a){return a.multidimensionalInfo&&a.visible&&a.useMapDimensionValue&&e.some(a.multidimensionalInfo.variables,function(a){return e.some(a.dimensions,function(a){return a.name===this.dimension?!0:void 0},this)?!0:void 0},this)?!0:void 0},this)},_updateUI:function(){w.remove(this.playPauseBtn.iconNode,this._iconClass);this._iconClass=this.playing?"mdsButton mdsPauseButton":"mdsButton mdsPlayButton";
w.add(this.playPauseBtn.iconNode,this._iconClass)},_bumpSlider:function(a){var b=this._slider.value;0<=a?!this._snap&&(0>b||b>=this.dimensionValues.length-1||b[0]>=this.dimensionValues.length-1||b[1]>=this.dimensionValues.length-1)?this._timer.isRunning&&(this.loop?(this._timer.stop(),this.prefetchedValues={},this.prefetchImgNodes={},2===this._thumbCount?this._snap?this._slider.set("value",this._getNextRangeIndex(b)):this._slider.set("value",[0,Math.abs(b[0]-b[1])]):this._slider.set("value",0),this._timer.start(),
this.playing=!0):this.pause()):2===this._thumbCount&&!this._snap&&b[0]<this.dimensionValues.length-1&&b[1]<this.dimensionValues.length-1?this._slider.set("value",[b[0]+1,b[1]+1]):1===this._thumbCount&&b<this.dimensionValues.length-1?this._slider.set("value",b+1):this._snap&&this._slider.set("value",this._getNextRangeIndex(b)):0>=b||0>=b[0]||0>=b[1]?this._timer.isRunning&&(this.loop?(this._timer.stop(),this.prefetchedValues={},2===this._thumbCount?this._snap?this._slider.set("value",this._getNextRangeIndex(b,
-1)):this._slider.set("value",[this.dimensionValues.length-1,this.dimensionValues.length-1-Math.abs(b[0]-b[1])]):this._slider.set("value",this.dimensionValues.length-1),this._timer.start(),this.playing=!0):this.pause()):(0<=b||0<=b[1])&&(2===this._thumbCount&&0<b[1]&&0<b[0]?this._snap?this._slider.set("value",this._getNextRangeIndex(b,-1)):this._slider.set("value",[b[0]-1,b[1]-1]):1===this._thumbCount&&0<b&&this._slider.set("value",b-1))},setThumbMovingRate:function(a){this.thumbMovingRate=a;this._timer&&
this._timer.setInterval(this.thumbMovingRate)},getFullDimensionRange:function(a){a=a||this.dimension;var b,c;return e.forEach(this._layers,function(d){d.multidimensionalInfo&&d.multidimensionalInfo.variables&&e.forEach(d.multidimensionalInfo.variables,function(d){e.forEach(d.dimensions,function(d){d.name===a&&d.extent&&d.extent.length&&1<d.extent.length&&((!h.isDefined(b)||d.extent[0]<b)&&(b=d.extent[0]),(!h.isDefined(c)||d.extent[1]>c)&&(c=d.extent[1]))},this)},this)},this),[b,c]},setThumbCount:function(a){this._thumbCount=
2==a?2:1;this.value=this.dimensionValues[this._slider.value];this._setupSlider()},clearDimensionalDefinition:function(a){var b,c,d=[];a&&a.mosaicRule&&a.mosaicRule.multidimensionalDefinition&&(c=a.mosaicRule,b=c.multidimensionalDefinition,e.forEach(b,function(a){a.dimensionName!==this.dimension&&d.push(a)},this),c.multidimensionalDefinition=d,a.setMosaicRule(c))},getUnit:function(){var a=null,b=!1;return this.unit=null,e.forEach(this._layers,function(c){c.multidimensionalInfo&&e.forEach(c.multidimensionalInfo.variables,
function(c){e.forEach(c.dimensions,function(c){if(c.name===this.dimension&&c.unit)if(null!=a||b){if(h.isDefined(c.unit)&&c.unit.replace("esri","").toLowerCase()!==a.toLowerCase())return a=null,void(b=!0)}else a=c.unit.replace("esri","")},this)},this)},this),a&&(a=a.replace("esri","")),this.unit=a,this.unitSymbol=this.getUnitSymbol(),this._hasUnitConflict=b,a},_getDimensionAlias:function(){this.dimensionAlias=this.dimension;e.some(this._layers,function(a){return a.fields&&a.fields.length&&e.some(a.fields,
function(a){return a.name&&a.name===this.dimension&&a.alias?(this.dimensionAlias=a.alias,!0):void 0},this)?!0:void 0},this)},_readMosaicRule:function(){var a;e.forEach(this._layers,function(b){b.mosaicRule&&b.mosaicRule.multidimensionalDefinition&&e.forEach(b.mosaicRule.multidimensionalDefinition,function(b){b&&b.dimensionName===this.dimension&&b.values&&(a=b.values.length&&b.values[0]&&b.values[0].length?b.values[0]:b.values)},this)},this);a&&(1===a.length?(this._thumbCount=1,this.useRanges=!1,this.value=
a[0]):(this._thumbCount=2,this.useRanges=!0,this.value=a))},hasUnitConflict:function(){return this.getUnit(),this._hasUnitConflict},resizeSlider:function(a,b){m.set(this.domNode,{height:a+"px",width:b+"px"});m.set(this.mdSliderTable,{height:a+"px",width:b+"px"});this.computeSliderStyle()},computeSliderStyle:function(){var a,b;return a=x.getContentBox(this.domNode).h-x.getContentBox(this.dimensionInfo).h,10>=u("ie")&&(a-=53),this.showPlayButton&&(a-=35),b="height: "+a+"px;",this._slider&&this._slider.domNode&&
m.set(this._slider.domNode,"height",a+"px"),b},getUnitSymbol:function(){if(!h.isDefined(this.unit))return null;var a=this.unit.toLowerCase();return"meters"===a||"meter"===a?this.unitSymbols.meter:"pascal"===a||"pascals"===a?this.unitSymbols.pascal:void 0},_snapToNearestRange:function(a){if(a&&a.length&&this._snap){var b,c,d,f,l,h,n,k,m=this;return f=[this.dimensionValues[a[1]],this.dimensionValues[a[0]]],f.sort(this._sortCompareFunction),e.some(this._dimensionObjects,function(a){return e.some(a.values,
function(a){return a&&a.length&&a[0]===f[0]&&a[1]===f[1]?!0:void 0})?!0:void 0},this)?a:(e.some(this._dimensionObjects,function(a){return e.some(a.values,function(a){return a&&a.length&&a[0]===f[0]?(b=g.clone(a.sort(this._sortCompareFunction)),!0):void 0},this)?!0:void 0},this)&&(e.some(this.dimensionValues,function(a,e){a===b[0]&&(c=e);a===b[1]&&(d=e)}),n=Math.abs(a[0]-c),l=[c,d]),e.some(this._dimensionObjects,function(a){return e.some(a.values,function(a){return a&&a.length&&a[1]===f[1]?(b=g.clone(a.sort(this._sortCompareFunction)),
!0):void 0},this)?!0:void 0},this)&&(e.some(this.dimensionValues,function(a,e){a===b[1]&&(d=e);a===b[0]&&(c=e)}),k=Math.abs(a[1]-d),h=[c,d]),a=n&&k?this._oldValue&&this._oldValue.length&&this._arraysEqual(this._oldValue,l)?h:this._oldValue&&this._oldValue.length&&this._arraysEqual(this._oldValue,h)?l:k>=n?l:h:l||h||a,this._update=!1,setTimeout(function(){m._slider.set("value",a)},100),a)}},_arraysEqual:function(a,b){var c;if(!h.isDefined(a)||!h.isDefined(b))return!1;if(a===b)return!0;if(a.length!==
b.length)return!1;a.sort(this._sortCompareFunction);b.sort(this._sortCompareFunction);for(c=0;c<a.length;++c)if(a[c]!==b[c])return!1;return!0},_getNextRangeIndex:function(a,b){if(!this._dimensionRangeValues||!this._dimensionRangeValues.length)return null;var c,d,f,g,k;return b=h.isDefined(b)?b:1,e.some(this._dimensionRangeValues,function(b,d){return this._arraysEqual(b,[this.dimensionValues[a[0]],this.dimensionValues[a[1]]])?(c=d,!0):void 0},this),d=0<b?(c+1)%this._dimensionRangeValues.length:(this._dimensionRangeValues.length+
c-1)%this._dimensionRangeValues.length,f=this._dimensionRangeValues[d],e.some(this.dimensionValues,function(a,b){return a===f[0]&&(g=b),a===f[1]&&(k=b),g&&k?!0:void 0},this),[g,k]}});return g.mixin(p,k),u("extend-esri")&&g.setObject("dijit.MultidimensionalSlider",p,M),p});