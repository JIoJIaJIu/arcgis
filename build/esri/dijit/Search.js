//>>built
require({cache:{"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\n        \x3c/div\x3e\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\n          \x3c/form\x3e\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\n          \x3c/div\x3e\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\n        \x3c/div\x3e\n      \x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\n  \x3c/div\x3e\n\x3c/div\x3e'}});
define("esri/dijit/Search","require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(P,A,h,G,Q,x,m,u,B,R,K,r,k,L,l,p,S,T,U,V,C,t,D,W,X,Y,z,H,Z,aa,I,ba,ca,E,J,M,N,da,O,ea,fa){A=A([T,U,V,Q],{declaredClass:"esri.dijit.Search",templateString:S,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(a,b){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",searchIcon:"searchIcon esri-icon-search",searchButtonText:"searchButtonText",searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",
searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",hasMultipleSources:"hasMultipleSources",showSuggestions:"showSuggestions",showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",
latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",
searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this.defaultSource={locator:new da("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["Addr_type","Match_addr","StAddr","City"],name:p.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,distance:5E4},placeholder:p.widgets.Search.main.placeholder,
highlightSymbol:(new Z(P.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:150,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enableInfoWindow:!0,showInfoWindowOnSelect:!0,enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,
enableLabel:!1,labelSymbol:(new ca).setColor(new ea([181,56,46,.9])).setFont(new E("14px",E.STYLE_NORMAL,E.VARIANT_NORMAL,E.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new W(p.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),searchResults:null,suggestResults:null,
selectedResult:null,magicKey:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:1,enableSearchingAll:!0};var c=h.mixin({},this.options,a);this.set(c);this._updateActiveSource();this._i18n=p;this._defaultSR=new Y(4326);this.domNode=b},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(h.hitch(this,this._init))},postCreate:function(){var a=this;this.inherited(arguments);this._moreResultsId=this.id+
"_more_results";this.own(u(this.submitNode,C,h.hitch(this,this._searchButton)));this.own(u(this.sourcesBtnNode,C,h.hitch(this,this._toggleSourcesMenu)));this.own(u(this.inputNode,C,h.hitch(this,this._inputClick)));this.own(u(this.clearNode,C,h.hitch(this,this._clearButton)));this.own(u(this.formNode,"submit",h.hitch(this,function(a){a.preventDefault();this._cancelSuggest();this.search()})));this.own(u(this.inputNode,"keyup",h.hitch(this,function(a){this._inputKey(a)})));this.own(u(this.sourcesBtnNode,
"keyup",h.hitch(this,function(a){this._sourceBtnKey(a)})));this.own(u(this.suggestionsNode,"li:click, li:keyup",function(b){a._suggestionsEvent(b,this)}));this.own(u(this.sourcesNode,"li:click, li:keyup",function(b){a._sourcesEvent(b,this)}));this.own(u(this.inputNode,"input, paste",h.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(u(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_show:click",h.hitch(this,
function(a){this._showMoreResultsClick(a)}))),this.own(u(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",h.hitch(this,function(a){this._moreResultsClick(a)}))),this.own(u(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",h.hitch(this,function(a){this._switchCoordinatesClick(a)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);this._updateButtonMode(this.enableButtonMode);
this.toggle(this.expanded)},destroy:function(){this.clear();l.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();r.get(this.inputNode,"value")&&r.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);k.remove(this.containerNode,this.css.hasValue);r.set(this.clearNode,"title","");this._hideMenus();this._closePopup();this._hideLoading();
this.emit("clear-search")},show:function(){L.set(this.domNode,"display","block")},hide:function(){L.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(k.add(this.containerNode,this.css.searchExpanded),k.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(k.remove(this.containerNode,this.css.searchExpanded),k.add(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",
!1))},toggle:function(a){this.enableButtonMode&&("undefined"==typeof a&&(a=!this.expanded),a?this.expand():this.collapse())},search:function(a){var b=new x;return this._mapLoaded().then(h.hitch(this,function(){this._searchDeferred(a).then(h.hitch(this,function(a){var d=a.results;this.set("searchResults",d);0===a.numResults&&(this._noResults(a.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",a);this._selectFirstResult(d,a.activeSourceIndex);b.resolve(d)}),h.hitch(this,
function(a){b.reject(a)}))})),b.promise},suggest:function(a){var b=new x;return this._mapLoaded().then(h.hitch(this,function(){this._suggestDeferred(a).then(h.hitch(this,function(a){if(a){var d=a.results;this.set("suggestResults",d);this._insertSuggestions(d,a.value);this.emit("suggest-results",a);b.resolve(d)}}),h.hitch(this,function(a){b.reject(a)}))})),b.promise},select:function(a){var b,c=this._getDefaultSymbol(a),d=this.labelSymbol,e=this.sources,f=this.activeSourceIndex,y=this.enableHighlight,
n=this.enableLabel,g=this.autoNavigate,q=this.showInfoWindowOnSelect,w=this.enableInfoWindow,k=this.infoTemplate,l=new z(a.feature.toJson());if(f===this._allIndex){var v=this._getSourceIndexOfResult(a);null!==v&&(b=e[v],f=v)}else b=e[f];if(b&&(b.hasOwnProperty("highlightSymbol")&&(c=b.highlightSymbol),b.hasOwnProperty("labelSymbol")&&(d=b.labelSymbol),b.hasOwnProperty("enableHighlight")&&(y=b.enableHighlight),b.hasOwnProperty("enableLabel")&&(n=b.enableLabel),b.hasOwnProperty("autoNavigate")&&(g=
b.autoNavigate),b.hasOwnProperty("showInfoWindowOnSelect")&&(q=b.showInfoWindowOnSelect),b.hasOwnProperty("enableInfoWindow")&&(w=b.enableInfoWindow),b.hasOwnProperty("infoTemplate")?k=b.infoTemplate:b.featureLayer&&b.featureLayer.infoTemplate&&(k=b.featureLayer.infoTemplate)),this._hideMenus(),this._hideLoading(),l){var e=this.highlightGraphic,m=this.graphicsLayer,v=this.labelGraphic,F=h.mixin({},l.attributes,{searchTheme:this.theme,searchResult:this._searchResultHTML(a),searchMoreResults:this.css.searchMoreResults,
searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(a)}),p=null;if(w&&(p=k),v?(v.setGeometry(l.geometry),v.setAttributes(F),v.setSymbol(d)):(v=new z(l.geometry,d,F),n&&(m?m.add(v):this.map&&this.map.graphics&&this.map.graphics.add(v))),v&&v.symbol&&"textsymbol"===v.symbol.type&&v.symbol.setText(a.name),e?(e.setGeometry(l.geometry),e.setAttributes(F),e.setInfoTemplate(p),e.setSymbol(c)):(e=new z(l.geometry,c,F,p),
y&&(m?m.add(e):this.map&&this.map.graphics&&this.map.graphics.add(e))),e&&e.symbol&&"textsymbol"===e.symbol.type&&e.symbol.setText(a.name),this.map&&this.map.infoWindow&&w&&q)this.map.infoWindow.setFeatures([e]),c=this._getPointFromGeometry(e.geometry),this.map.infoWindow.show(c);this.map&&g&&a&&a.hasOwnProperty("extent")&&"function"==typeof this.map.setExtent&&this.map.setExtent(a.extent);this.set("highlightGraphic",e);this.set("labelGraphic",v)}this.set("selectedResult",a);this.emit("select-result",
{result:a,source:b,sourceIndex:f})},focus:function(){t.focus(this.inputNode)},blur:function(){t.curNode&&t.curNode.blur()},clearGraphics:function(){var a=this.highlightGraphic,b=this.graphicsLayer,c=this.labelGraphic;a&&(b?b.remove(a):this.map&&this.map.graphics&&this.map.graphics.remove(a));c&&(b?b.remove(c):this.map&&this.map.graphics&&this.map.graphics.remove(c));this.set("labelGraphic",null);this.set("highlightGraphic",null)},_mapLoaded:function(){var a=new x;return this.map?this.map.loaded?a.resolve():
u.once(this.map,"load",h.hitch(this,function(){a.resolve()})):a.resolve(),a.promise},_init:function(){this._getMapLayers().then(h.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();t.focus(this.inputNode)},_error:function(a){return Error(this.declaredClass+" "+a)},_searchDeferred:function(a){var b,c=new x,d=this.value,e=this.activeSourceIndex;a&&a.hasOwnProperty("index")&&(e=a.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();
var f={magicKey:this.magicKey,text:d};return a?"string"==typeof a?(f.text=a,b=this._searchQueries(f)):b=this._searchQueries("object"==typeof a&&a.hasOwnProperty("magicKey")?a:"object"==typeof a&&a.hasOwnProperty("geometry")?{geometry:a}:"object"==typeof a&&a.hasOwnProperty(this._objectIdIdentifier)?a:"object"==typeof a&&"point"===a.type?{point:a}:a instanceof Array&&2===a.length?{latlon:a}:f):b=this._searchQueries(f),b.always(h.hitch(this,function(a){a=this._formatResults(a,e,d);c.resolve(a)})),c.promise},
_suggestDeferred:function(a){var b,c=new x;this._deferreds.push(c);a||(a=this.value);var d=this.activeSourceIndex;return b=this._suggestQueries({text:a}),b.always(h.hitch(this,function(b){var f;if(b)for(var y=0;y<b.length;y++)b[y]&&(f=!0);f?(b=this._formatResults(b,d,a),c.resolve(b)):c.resolve()})),c.promise},_getDefaultSymbol:function(a){var b,c,d,e;this.map&&(e=this.map.getBasemap());e||(e="topo");a&&a.feature&&a.feature.geometry&&(d=a.feature.geometry.type);if(d&&((a=fa.getSchemes({theme:"default",
basemap:e,geometryType:d}))&&(c=a.primaryScheme),c)){c.color&&c.hasOwnProperty("opacity")&&(c.color.a=c.opacity);b=c;a=c.color;c=c.size;var f;switch(d){case "point":f=new aa;f.setColor(a);f.setSize(null!==c?c:b.size);d=new I;d.setColor(b.outline.color);d.setWidth(b.outline.width);f.setOutline(d);break;case "line":f=new I;f.setColor(a);f.setWidth(null!==c?c:b.width);break;case "polygon":f=new ba,f.setColor(a),d=new I,d.setColor(b.outline.color),d.setWidth(b.outline.width),f.setOutline(d)}b=f}return b},
_selectFirstResult:function(a,b){if(this.autoSelect&&a){var c;b===this._allIndex?c=this._getFirstResult(a):a[b]&&a[b][0]&&(c=a[b][0]);c&&this.select(c)}},_getSourceIndexOfResult:function(a){var b=this.searchResults;if(b)for(var c in b)if(b[c]&&b[c].length)for(var d=0;d<b[c].length;d++)if(b[c][d]===a)return parseInt(c,10);return null},_getFirstResult:function(a){if(a)for(var b in a)if(a[b]&&a[b][0])return a[b][0];return!1},_onFocus:function(){this.map&&"function"==typeof this.map.disableKeyboardNavigation&&
this.map.disableKeyboardNavigation();this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();this.map&&"function"==typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this.enableButtonMode&&this.loaded&&this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var a=new x;if(this.addLayersFromMap&&this.map){var b=[],c=this.map.graphicsLayerIds;if(c&&c.length){for(var d=0;d<c.length;d++){var e=this.map.getLayer(c[d]);
e&&b.push(this._featureLayerLoaded(e))}H(b).always(h.hitch(this,function(b){for(var c,d=this.sources,e=0;e<b.length;e++)b[e]&&b[e].loaded&&"Feature Layer"===b[e].type&&(d.push({featureLayer:b[e],enableSuggestions:!0}),c=!0);c&&this.set("sources",d);a.resolve()}))}else a.resolve()}else a.resolve();return a.promise},_switchCoordinatesClick:function(a){a.preventDefault();(a=r.get(a.target,"data-switch-coordinates"))&&(this._cancelSuggest(),this.set("value",a),this.search())},_moreResultsClick:function(a){a.preventDefault();
var b=a.target;a=parseInt(r.get(b,"data-source-index"),10);var b=parseInt(r.get(b,"data-index"),10),c=this.searchResults;c&&c[a]&&(a=c[a][b])&&this.select(a)},_showMoreResultsClick:function(a){a.preventDefault();if(a=K.byId(this._moreResultsId)){k.toggle(a,this.css.searchShowMoreResults);var b=K.byId(this._moreResultsId+"_show");b&&(k.contains(a,this.css.searchShowMoreResults)?r.set(b,"textContent",p.widgets.Search.main.hideMoreResults):r.set(b,"textContent",p.widgets.Search.main.showMoreResults))}},
_featureLayerLoaded:function(a){var b=new x;if(a.loaded)b.resolve(a);else if(a.loadError)b.reject(this._error("Layer failed to load."));else{var c,d;c=u.once(a,"load",h.hitch(this,function(){d.remove();b.resolve(a)}));d=u.once(a,"error",h.hitch(this,function(){c.remove();b.reject(this._error("Layer could not be loaded."))}))}return b.promise},_getObjectSize:function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},_sourcesEvent:function(a,b){var c=r.get(b,"data-index"),d=B("li",this.sourcesNode),
e=G.indexOf(d,b);c!==this._allIndex&&(c=parseInt(c,10));var f;"click"===a.type||a.keyCode===m.ENTER?(this.set("activeSourceIndex",c),t.focus(this.inputNode),this._hideSourcesMenu()):a.keyCode===m.UP_ARROW?(a.stopPropagation(),a.preventDefault(),f=e-1,t.focus(0>f?this.sourcesBtnNode:d[f])):a.keyCode===m.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),f=e+1,t.focus(f>=d.length?this.sourcesBtnNode:d[f])):a.keyCode===m.ESCAPE&&(this._hideSourcesMenu(),t.focus(this.inputNode))},_suggestionsEvent:function(a,
b){var c=r.get(b,"data-source-index"),d=parseInt(r.get(b,"data-index"),10),e=B("li",this.suggestionsNode),f=this.sources,h=G.indexOf(e,b);c!==this._allIndex&&(c=parseInt(c,10));var n;if(this._clearQueryTimeout(),"click"===a.type||a.keyCode===m.ENTER){var g,e=this.suggestResults;if(e&&e[c]&&e[c][d]&&(g=e[c][d]),g)(g.index=c,f[c].featureLayer)?g[this._objectIdIdentifier]=g.feature.attributes[f[c].featureLayer.objectIdField]:g.magicKey&&g.text&&(this.set("value",g.text),this.set("magicKey",g.magicKey)),
this.search(g),t.focus(this.inputNode)}else a.keyCode===m.BACKSPACE||a.keyCode===m.DELETE?t.focus(this.inputNode):a.keyCode===m.UP_ARROW?(a.stopPropagation(),a.preventDefault(),n=h-1,t.focus(0>n?this.inputNode:e[n])):a.keyCode===m.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),n=h+1,t.focus(n>=e.length?this.inputNode:e[n])):a.keyCode===m.ESCAPE&&(this._hideMenus(),t.focus(this.inputNode))},_getResultName:function(a){var b;return a.hasOwnProperty("name")&&null!==a.name&&(b=a.name.toString()),b||
(b=p.widgets.Search.main.untitledResult),b},_getSuggestionName:function(a){var b,c;return a.hasOwnProperty("name")&&(c=a.name.toString()),b=a.text||c,b||(b=p.widgets.Search.main.untitledResult),b},_searchResultHTML:function(a){var b="";if(a.feature&&a.feature.attributes&&a.feature.attributes.Addr_type&&"LatLong"===a.feature.attributes.Addr_type){var c,d,e=a.name.split(" ");(2===e.length&&(c=e[0],d=e[1]),d&&c)?(a=parseFloat(c),d=parseFloat(d),c=d+", "+a,b+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+
'"\x3e',b+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+p.widgets.Search.main.lonlat+"\x3c/div\x3e",b+=a+", "+d,b=b+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),a===d||90<a||-90>a||180<d||-180>d||(b+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+p.widgets.Search.main.reverseLonLatHeader+"\x3c/div\x3e",b+='\x3ca data-switch-coordinates\x3d"'+c+'" tabindex\x3d"0" href\x3d"#"\x3e'+c+"\x3c/a\x3e",b+="\x3c/div\x3e")):b=a.name}else b=a.name;return b},_moreResultsHTML:function(a){var b=
"",c="",d=this.searchResults,e=this.sources,f=0;if(d){var c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),c=c+('\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+p.widgets.Search.main.showMoreResults+"\x3c/a\x3e"),c=c+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsList+'"\x3e'),c=c+('\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e'),h;for(h in d)if(d[h]){var n=d[h].length;if(n){var g=1===n&&d[h][0]===a;if(1<this._getObjectSize(d)&&!g)var q=this._getSourceName(h),
c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+q+"\x3c/div\x3e");if(n&&!g){c+="\x3cul\x3e";q=e[h].maxResults||this.maxResults;for(g=0;n>g&&q>g;++g)if(d[h][g]!==a){var w=this._getResultName(d[h][g]),c=c+('\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+g+'" data-source-index\x3d"'+h+'" href\x3d"#"\x3e'+w+"\x3c/a\x3e\x3c/li\x3e");f++}c+="\x3c/ul\x3e"}}}c+="\x3c/div\x3e";c+="\x3c/div\x3e"}return f&&(b+=c),b},_validField:function(a,b){return a.getField(b)},_validFields:function(a,
b){if(a&&b&&b.length){for(var c=0;c<b.length;c++)if(!this._validField(a,b[c]))return!1;return!0}return!1},_getCodedName:function(a,b){if(a&&a.length)for(var c=0,d=a.length;d>c;c++){var e=a[c];if(e.code===b)return e.name}},_getCodedValue:function(a,b,c){if(a&&a.length)for(var d=0,e=a.length;e>d;d++){var f=a[d],h=f.name,n=b;if(c||(h=h.toLowerCase(),n=n.toLowerCase()),h===n)return f.code}return!1},_whereClause:function(a,b,c,d){var e=null;if(a){var f="";if(this.reHostedFS.test(b.url)&&this._containsNonLatinCharacter(a)&&
(f="N"),c&&c.length)for(var h=0,n=c.length;n>h;h++){var g="",q=a.replace(/\'/g,"''"),g=c[h],w=b.getField(g),k=b.getDomain(g);if(k&&"codedValue"===k.type&&(q=this._getCodedValue(k.codedValues,q,d)),!1!==q)w=w.type,"esriFieldTypeString"===w||"esriFieldTypeDate"===w?g=d?g+" \x3d "+f+"'"+q+"'":"UPPER("+g+") LIKE "+f+"'%"+q.toUpperCase()+"%'":"esriFieldTypeSmallInteger"===w||"esriFieldTypeInteger"===w||"esriFieldTypeSingle"===w||"esriFieldTypeDouble"===w?(q=parseFloat(q),g=isNaN(q)?!1:g+" \x3d "+q):g=
g+" \x3d "+q,g&&(e?e+=" or ":e="",e+=g)}}return e},_suggest:function(a){a||(a={index:this.activeSourceIndex,text:this.value});var b=new x,c=a.index,d=this.sources[c],e=this.enableSuggestions;d.hasOwnProperty("enableSuggestions")&&(e=d.enableSuggestions);var f,k=0;a.hasOwnProperty("text")&&a.text&&(f=h.trim(a.text),k=a.text.length);a=d.minCharacters||this.minCharacters;if(e&&f&&k>=a&&this._supportsPagination(d)){var n="";d.prefix&&(n+=d.prefix);n+=f;d.suffix&&(n+=d.suffix);var g=this._defaultSR;this.map&&
(g=this.map.spatialReference);e={};if(d.locator){if(d.categories&&(e.categories=d.categories),d.locator.outSpatialReference=g,this.map&&d.localSearchOptions&&d.localSearchOptions.hasOwnProperty("distance")&&d.localSearchOptions.hasOwnProperty("minScale"))f=this._getScale(),(!d.localSearchOptions.minScale||f&&f<=parseFloat(d.localSearchOptions.minScale))&&(e.location=this.map.extent.getCenter(),e.distance=d.localSearchOptions.distance);e.text=n;d.useMapExtent&&this.map&&this.map.extent&&(e.searchExtent=
this.map.extent);d.searchExtent&&(e.searchExtent=d.searchExtent);e.maxSuggestions=d.maxSuggestions||this.maxSuggestions;d.sourceCountry&&(e.countryCode=d.sourceCountry);d.countryCode&&(e.countryCode=d.countryCode);d.locator.suggestLocations(e).then(h.hitch(this,function(a){b.resolve(a)}),h.hitch(this,function(a){a||(a=this._error("Locator suggestLocations could not be performed."));b.reject(a)}))}else d.featureLayer?this._featureLayerLoaded(d.featureLayer).then(h.hitch(this,function(){var a=this._getDisplayField(d),
e=d.searchFields||[a],f=[];d.suggestionTemplate?d.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,function(a,b){f.push(b)}):f=[a];-1===G.indexOf(f,d.featureLayer.objectIdField)&&f.push(d.featureLayer.objectIdField);var a=this._validField(d.featureLayer,a),k=this._validFields(d.featureLayer,f),l=this._validFields(d.featureLayer,e);if(a&&k&&l){a=new O;d.hasOwnProperty("suggestQueryParams")&&h.mixin(a,d.suggestQueryParams);a.outSpatialReference=g;a.returnGeometry=!1;a.num=d.maxSuggestions||this.maxSuggestions;
a.outFields=f;d.useMapExtent&&this.map&&this.map.extent&&(a.geometry=this.map.extent);d.searchExtent&&(a.geometry=d.searchExtent);var m;(e=this._whereClause(n,d.featureLayer,e,!1))&&(a.where=e,m=!0);m?d.featureLayer.queryFeatures(a,h.hitch(this,function(a){var d;(a=a.features)&&(d=this._hydrateResults(a,c,!0));b.resolve(d)}),h.hitch(this,function(a){a||(a=this._error("FeatureLayer queryFeatures errored with suggestions"));b.reject(a)})):b.resolve()}else b.reject(this._error("Invalid FeatureLayer field"))})):
b.reject(this._error("Invalid source"))}else b.resolve();return b.promise},_supportsPagination:function(a){var b;return a.locator?b=!0:a.featureLayer&&a.featureLayer.advancedQueryCapabilities&&a.featureLayer.advancedQueryCapabilities.supportsPagination&&(b=!0),b},_suggestQueries:function(a){var b,c=this.sources,d=this.activeSourceIndex,e=[];if(d===this._allIndex)for(d=0;d<c.length;d++)b=a,b.index=d,b=this._suggest(b),e.push(b);else a.index=d,b=this._suggest(a),e.push(b);return H(e)},_getPointFromGeometry:function(a){var b;
switch(a.type){case "extent":b=a.getCenter();break;case "multipoint":b=a.getExtent().getCenter();break;case "point":b=a;break;case "polygon":b=a.getExtent().getCenter();break;case "polyline":b=a.getExtent().getCenter()}return b},_searchQueries:function(a){a.hasOwnProperty("index")||(a.index=this.activeSourceIndex);var b,c=[];if(a.index===this._allIndex)for(var d=this.sources,e=0;e<d.length;e++)b=a,b.index=e,b=this._search(b),c.push(b);else a=this._search(a),c.push(a);return H(c)},_searchButton:function(){this.enableButtonMode&&
!this.expanded?(this.expand(),t.focus(this.inputNode)):(this._cancelSuggest(),this.search())},_search:function(a){a||(a={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});var b,c,d=new x,e=a.index,f=this.sources[e];if(a.hasOwnProperty("text")&&a.text&&(c=h.trim(a.text)),f){var k="";f.prefix&&!a.magicKey&&(k+=f.prefix);k+=c;f.suffix&&!a.magicKey&&(k+=f.suffix);var n=this._defaultSR;if(this.map&&(n=this.map.spatialReference),f.locator)if(a.hasOwnProperty("text")&&
c){var g={};if(f.categories&&(g.categories=f.categories),n&&(f.locator.outSpatialReference=n),this.map&&f.localSearchOptions&&f.localSearchOptions.hasOwnProperty("distance")&&f.localSearchOptions.hasOwnProperty("minScale")){var l=this._getScale();(!f.localSearchOptions.minScale||l&&l<=parseFloat(f.localSearchOptions.minScale))&&(g.location=this.map.extent.getCenter(),g.distance=f.localSearchOptions.distance)}g.address={};g.maxLocations=f.maxResults||this.maxResults;f.useMapExtent&&this.map&&this.map.extent&&
(g.searchExtent=this.map.extent);f.searchExtent&&(g.searchExtent=f.searchExtent);f.sourceCountry&&(g.countryCode=f.sourceCountry);f.countryCode&&(g.countryCode=f.countryCode);a.magicKey&&(g.magicKey=a.magicKey);f.singleLineFieldName?g.address[f.singleLineFieldName]=k:g.address["Single Line Input"]=k;f.outFields&&(g.outFields=f.outFields);f.locator.addressToLocations(g).then(h.hitch(this,function(a){a=this._hydrateResults(a,e,!1);d.resolve(a)}),h.hitch(this,function(a){a||(a=this._error("Locator addressToLocations could not be performed"));
d.reject(a)}))}else a.geometry?(b=this._getPointFromGeometry(a.geometry.geometry))?this._reverseGeocodePoint(e,b).then(function(a){d.resolve(a)},function(a){d.reject(a)}):d.reject(this._error("Invalid point to reverse geocode")):a.point?this._reverseGeocodePoint(e,a.point).then(function(a){d.resolve(a)},function(a){d.reject(a)}):a.latlon?(g=new J(a.latlon,this._defaultSR),this._reverseGeocodePoint(e,g).then(function(a){d.resolve(a)},function(a){d.reject(a)})):a.hasOwnProperty("text")&&!c?d.resolve([]):
d.reject(this._error("Invalid query type for Locator"));else f.featureLayer?this._featureLayerLoaded(f.featureLayer).then(h.hitch(this,function(){var g=this._getDisplayField(f),l=f.searchFields||[g],g=this._validField(f.featureLayer,g),m=this._validFields(f.featureLayer,l);if(g&&m){g=new O;if(f.hasOwnProperty("searchQueryParams")&&h.mixin(g,f.searchQueryParams),n)g.outSpatialReference=n,(m=N.getUnitValueForSR(n))&&(g.maxAllowableOffset=m);g.returnGeometry=!0;f.outFields&&(g.outFields=f.outFields);
var p;a.hasOwnProperty(this._objectIdIdentifier)||(this._supportsPagination(f)&&(g.num=f.maxResults||this.maxResults),f.useMapExtent&&this.map&&this.map.extent&&(g.geometry=this.map.extent),f.searchExtent&&(g.geometry=f.searchExtent),p=f.exactMatch);var q;a.hasOwnProperty("text")&&c?(l=this._whereClause(k,f.featureLayer,l,p))?(g.where=l,q=!0):q=!1:a.hasOwnProperty(this._objectIdIdentifier)?(g.objectIds=[a[this._objectIdIdentifier]],q=!0):a.geometry?(g.geometry=a.geometry,q=!0):a.point?(g.geometry=
a.point,q=!0):a.latlon?(b=new J(a.latlon,this._defaultSR),g.geometry=b,q=!0):a.hasOwnProperty("text")&&!c?(d.resolve([]),q=!1):(d.reject(this._error("Invalid query type for FeatureLayer")),q=!1);q?f.featureLayer.queryFeatures(g,h.hitch(this,function(a){var b;(a=a.features)&&(b=this._hydrateResults(a,e,!1));d.resolve(b)}),h.hitch(this,function(a){a||(a=this._error("FeatureLayer queryFeatures could not be performed"));d.reject(a)})):d.resolve()}else d.reject(this._error("Invalid FeatureLayer field"))})):
d.reject(this._error("Invalid source"))}else d.reject(this._error("Source is undefined"));return d.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_formatResults:function(a,b,c){c={activeSourceIndex:b,value:c,numResults:0,numErrors:0,errors:null,results:null};var d={},e={};if(a)if(b===this._allIndex)for(b=0;b<a.length;b++)a[b]&&(a[b]instanceof Error?(d[b]=a[b],c.numErrors++):(e[b]=a[b],c.numResults+=a[b].length));else a[0]&&(a[0]instanceof Error?(d[b]=a[0],
c.numErrors++):(e[b]=a[0],c.numResults+=a[0].length));return c.numErrors&&(c.errors=d),c.numResults&&(c.results=e),c},_reverseGeocodePoint:function(a,b){var c=new x,d=this.sources[a];if(b&&d){var e=d.locationToAddressDistance||this.locationToAddressDistance;d.locator.outSpatialReference=this._defaultSR;this.map&&(d.locator.outSpatialReference=this.map.spatialReference);d.locator.locationToAddress(b,e,h.hitch(this,function(b){b=this._hydrateResults([b],a,!1);c.resolve(b)}),h.hitch(this,function(a){a||
(a=this._error("Locator locationToAddress could not be performed"));c.reject(a)}))}else c.reject(this._error("No point or source defined for reverse geocoding"));return c.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var a=0;a<this._deferreds.length;a++)this._deferreds[a].cancel(this.declaredClass+" cancelling request");this._deferreds=[]},_sourceBtnKey:function(a){if(a){var b=B("li",this.sourcesNode);a.keyCode===m.UP_ARROW?(a.stopPropagation(),a.preventDefault(),
this._showSourcesMenu(),(a=b.length)&&t.focus(b[a-1])):a.keyCode===m.DOWN_ARROW&&(a.stopPropagation(),a.preventDefault(),this._showSourcesMenu(),b[0]&&t.focus(b[0]))}},_inputKey:function(a){if(a){var b=B("li",this.suggestionsNode),c=this.suggestResults;if(a.keyCode===m.TAB||a.keyCode===m.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(a.keyCode===m.UP_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),c&&this._showSuggestionsMenu(),(a=b.length)&&t.focus(b[a-1]);else if(a.keyCode===
m.DOWN_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),c&&this._showSuggestionsMenu(),b[0]&&t.focus(b[0]);else{if(a.ctrlKey||a.metaKey||a.keyCode===m.copyKey||a.keyCode===m.LEFT_ARROW||a.keyCode===m.RIGHT_ARROW||a.keyCode===m.ENTER)return a;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();this._changeValue();this._queryTimer=setTimeout(h.hitch(this,function(){this.suggest()}),this.suggestionDelay)},
_changeValue:function(){this.set("magicKey",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},_getSourceName:function(a){var b=this.sources,c=b[a].name;return!c&&b[a].featureLayer&&(c=b[a].featureLayer.name),c||(c=p.widgets.Search.main.untitledSource),c},_insertSuggestions:function(a,b){if(this.enableSuggestionsMenu&&this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();var c,d=
this.sources;if(a){c=l.create("div");for(var e in a)if(a[e]&&a[e].length){var f=this._getSourceName(e);1<d.length&&this.activeSourceIndex===this._allIndex&&l.create("div",{className:this.css.searchMenuHeader,textContent:f},c);for(var f=l.create("ul",{role:"menu"},c),h=d[e].maxSuggestions||this.maxSuggestions,k=0;k<a[e].length&&h>k;++k)for(var g=l.create("li",{"data-index":k,"data-source-index":e,role:"menuitem",tabindex:0},f),m=new RegExp("("+b+")","gi"),m=this._getSuggestionName(a[e][k]).replace(m,
"|$1|").split("|"),p=m.length,t=0;p>t;t++){var r=m[t];r.toLowerCase()===b.toLowerCase()?l.create("strong",{textContent:r},g):(r=document.createTextNode(r),l.place(r,g))}}}c?(l.place(c,this.suggestionsNode,"only"),this._showSuggestionsMenu()):(l.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(a){if(this.enableSourcesMenu&&a&&1<a.length){var b,c,d=this.activeSourceIndex,e=l.create("ul",{role:"menu"});this.enableSearchingAll&&(b="",d===this._allIndex&&(b="active"),
l.create("li",{"data-index":this._allIndex,role:"menuitem",className:b,tabIndex:0,textContent:p.widgets.Search.main.all},e));for(c=0;c<a.length;c++){b="";c===d&&(b=this.css.activeSource);var f=this._getSourceName(c);l.create("li",{"data-index":c,role:"menuitem",className:b,tabIndex:0,textContent:f},e)}k.add(this.containerNode,this.css.hasMultipleSources);l.place(e,this.sourcesNode,"only")}else k.remove(this.containerNode,this.css.hasMultipleSources),l.empty(this.sourcesNode)},_showLoading:function(){k.add(this.containerNode,
this.css.searchLoading)},_hideLoading:function(){k.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?(k.add(this.containerNode,this.css.hasValue),r.set(this.clearNode,"title",p.widgets.Search.main.clearButtonTitle)):this.clear()},_closePopup:function(){this.enableInfoWindow&&this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(a){var b;a&&(b=h.trim(a));var c=l.create("div",{className:this.css.searchNoResultsBody});a&&b?(l.create("div",
{className:this.css.searchNoResultsHeader,textContent:p.widgets.Search.main.noResults},c),l.create("div",{className:this.css.searchNoResultsText,textContent:D.substitute({value:'"'+a+'"'},p.widgets.Search.main.noResultsFound)},c)):(a=l.create("div",{},c),l.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},a),l.create("span",{className:this.css.searchNoValueText,textContent:p.widgets.Search.main.emptyValue},a));l.place(c,this.noResultsMenuNode,"only")},_hideMenus:function(){this._hideSourcesMenu();
this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){k.remove(this.containerNode,this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();k.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){k.remove(this.containerNode,this.css.showSources)},_hideSuggestionsMenu:function(){k.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();
k.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();k.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();k.toggle(this.containerNode,this.css.showSources)},_getFirstStringField:function(a){if(a&&(a=a.fields)&&a.length)for(var b=0;b<a.length;b++){var c=a[b];if("esriFieldTypeString"===c.type)return c.name}return""},_getDisplayField:function(a){return a.displayField||
a.featureLayer.displayField||this._getFirstStringField(a.featureLayer)},_validExtent:function(a){return a&&a.xmin&&"NaN"!==a.xmin&&a.ymin&&"NaN"!==a.ymin&&a.xmax&&"NaN"!==a.xmax&&a.ymax&&"NaN"!==a.ymax?!0:!1},_hydrateResult:function(a,b,c){var d,e={},f=this._defaultSR;b=this.sources[b];if(this.map&&(f=this.map.spatialReference),a.hasOwnProperty("text")&&a.hasOwnProperty("magicKey"))return a;if(a.hasOwnProperty("geometry"))d=new z(a.toJson()),e.feature=d,(d=e.feature.geometry)&&d.setSpatialReference(f);
else if(a.hasOwnProperty("location")){var h=new J(a.location.x,a.location.y,f);d={};a.hasOwnProperty("attributes")&&(d=a.attributes);a.hasOwnProperty("score")&&(d.score=a.score);e.feature=new z(h,null,d,null)}else e.feature=null;if(a.hasOwnProperty("extent")&&this._validExtent(a.extent))e.extent=new M(a.extent),e.extent.setSpatialReference(f);else if(e.feature&&e.feature.geometry)switch(e.feature.geometry.type){case "extent":e.extent=e.feature.geometry;break;case "multipoint":e.extent=e.feature.geometry.getExtent();
break;case "polygon":e.extent=e.feature.geometry.getExtent();break;case "polyline":e.extent=e.feature.geometry.getExtent();break;case "point":this.map?(f=this.zoomScale,b&&b.zoomScale&&(f=b.zoomScale),e.extent=this._getScale()>f?N.getExtentForScale(this.map,f).centerAt(e.feature.geometry):this.map.extent.centerAt(e.feature.geometry)):e.extent=new M({xmin:e.feature.geometry.x-.25,ymin:e.feature.geometry.y-.25,xmax:e.feature.geometry.x+.25,ymax:e.feature.geometry.y+.25,spatialReference:this._defaultSR})}else e.extent=
null;(e.name="",b.featureLayer)?b.suggestionTemplate&&c?e.name=D.substitute(a.attributes,b.suggestionTemplate):b.searchTemplate?e.name=D.substitute(a.attributes,b.searchTemplate):(c=this._getDisplayField(b),b=b.featureLayer.getDomain(c),c&&a.hasOwnProperty("attributes")&&a.attributes.hasOwnProperty(c)&&(a=a.attributes[c],e.name=b&&"codedValue"===b.type?this._getCodedName(b.codedValues,a):a)):a.address&&b.searchTemplate?e.name=D.substitute(a.address,b.searchTemplate):a.hasOwnProperty("name")?e.name=
a.name:a.hasOwnProperty("attributes")&&"object"==typeof a.attributes&&a.attributes.Match_addr?(e.name=a.attributes.Match_addr,a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&a.attributes.StAddr&&a.attributes.City&&(e.name+=" - "+a.attributes.StAddr+", "+a.attributes.City)):a.hasOwnProperty("address")&&"string"==typeof a.address?e.name=a.address:a.hasOwnProperty("address")&&"object"==typeof a.address&&a.address.hasOwnProperty("Address")?e.name=a.address.Address:e.feature&&e.feature.geometry&&
(e.name=e.feature.geometry.x+","+e.feature.geometry.y);return e},_getScale:function(){var a;return this.map&&"function"==typeof this.map.getScale&&(a=this.map.getScale()),a},_hydrateResults:function(a,b,c){var d=[],e=0;if(a&&a.length)for(e;e<a.length;e++){var f=this._hydrateResult(a[e],b,c);d.push(f)}return d},_containsNonLatinCharacter:function(a){for(var b=0;b<a.length;b++)if(255<a.charCodeAt(b))return!0;return!1},_setPlaceholder:function(a){var b="",c=this.sources[a];a===this._allIndex?b=this.allPlaceholder||
p.widgets.Search.main.allPlaceholder:c&&c.placeholder&&(b=c.placeholder);var d=p.widgets.Search.main.all;c&&(d=this._getSourceName(a));r.set(this.sourceNameNode,"textContent",d);r.set(this.inputNode,"placeholder",b);r.set(this.inputNode,"title",b)},_updateActiveSource:function(){var a,b=this.sources,c=this.activeSourceIndex;b&&b[c]&&(a=b[c]);a?this.set("activeSource",a):this.set("activeSource",null)},_updateVisible:function(){this.visible?this.show():this.hide()},_updateButtonMode:function(a){a?(k.toggle(this.containerNode,
this.css.searchExpanded,this.expanded),k.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),k.add(this.containerNode,this.css.hasButtonMode)):(k.remove(this.containerNode,this.css.searchExpanded),k.remove(this.containerNode,this.css.searchCollapsed),k.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(){var a=this.sources;a&&1===a.length||!this.enableSearchingAll?this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(a){this._set("enableSourcesMenu",
a);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(a){this._set("enableSearchingAll",a);this._created&&(this._setDefaultActiveSourceIndex(),this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(a){this._set("sources",a);this._created&&(this._setDefaultActiveSourceIndex(),this._hideMenus(),this._insertSources(a))},_setAllPlaceholderAttr:function(a){this._set("allPlaceholder",a);this._created&&this._setPlaceholder(this.activeSourceIndex)},
_setActiveSourceIndexAttr:function(a){this._set("activeSourceIndex",a);this._updateActiveSource();this._created&&(this._setPlaceholder(a),this._hideMenus(),this._insertSources(this.sources))},_setMaxLengthAttr:function(a){this._set("maxLength",a);this._created&&r.set(this.inputNode,"maxLength",a)},_setValueAttr:function(a){this.set("magicKey",null);this._set("value",a);this._created&&(r.set(this.inputNode,"value",a),this._checkStatus())},_setVisibleAttr:function(a){this._set("visible",a);this._created&&
this._updateVisible()},_setEnableButtonModeAttr:function(a){this._set("enableButtonMode",a);this._created&&this._updateButtonMode(a)},_setThemeAttr:function(a){this._created&&(k.remove(this.domNode,this.theme),k.add(this.domNode,a));this._set("theme",a)}});return R("extend-esri")&&h.setObject("dijit.Search",A,X),A});