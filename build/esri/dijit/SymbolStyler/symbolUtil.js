//>>built
define("esri/dijit/SymbolStyler/symbolUtil",["../../symbol","dojo/Deferred","dojo/dom-construct","dojo/on","dojox/gfx"],function(h,q,m,n,r){var g={_pureOutlineStyles:"x,cross",isPoint:function(a){return g.isType(a,"marker")},isType:function(a,b){return a&&-1<a.type.indexOf(b+"symbol")},isLine:function(a){return g.isType(a,"line")},isPolygon:function(a){return g.isType(a,"fill")},hasPureOutlineStyle:function(a){return a&&-1<g._pureOutlineStyles.indexOf(a.style)},getOutline:function(a){return"simplelinesymbol"===
a.type||"cartographiclinesymbol"===a.type?a:a.outline},cloneSymbol:function(a){return h.jsonUtils.fromJson(a.toJson())},setOutlineWidth:function(a,b){!isNaN(b)&&a&&g.getOutline(a).setWidth(b)},setOutlineStyle:function(a,b){if(b&&a){var c=g.getOutline(a);b=c.color?b:h.SimpleLineSymbol.STYLE_NULL;c.setStyle(b)}},setSize:function(a,b){if(a&&!isNaN(b)){var c,d=a.width,e=b;if(d!=e)if("picturemarkersymbol"===a.type){if(c=a.url,a.setHeight(a.height/a.width*e),a.setWidth(e),c&&"http://"!==c&&(-1!==c.indexOf("http://")||
-1!==c.indexOf("data:")))if(a.xoffset||a.yoffset)e=a.width,c=e/d,a.setOffset(Math.round(a.xoffset*c),Math.round(a.yoffset*c))}else a.setSize(e)}},getMarkerLength:function(a){return isNaN(a.width)?a.size:Math.max(a.width,a.height)},hasColor:function(a){return a&&a.color},setFillColor:function(a,b){a.setColor(b)},setOutlineColor:function(a,b){g.getOutline(a).setColor(b)},renderOnSurface:function(a,b){if(a){var c,d,e,f,m,k=80,l=30,n=g.isLine(a),p=a.outline?1.5*a.outline.width:1;if(n)k=190,l=20;else if("simplemarkersymbol"===
a.type)l=k=a.size;else if("picturemarkersymbol"===a.type){if(!a.url||"http://"===a.url||-1===a.url.indexOf("http://")&&-1===a.url.indexOf("https://")&&-1===a.url.indexOf("data:"))return;l=k=Math.max(a.width,a.height)}return k+=p,l+=p,c=r.createSurface(b,k,l),d=h.jsonUtils.getShapeDescriptors(a),n&&(d.defaultShape.path="M -90,0 L 90,0 E"),e=c.createShape(d.defaultShape).setFill(d.fill).setStroke(d.stroke),f=c.getDimensions(),m={dx:.5*f.width,dy:.5*f.height},e.applyTransform(m),c}},toFullLineStyle:function(a){switch(a){case "dot":a=
h.SimpleLineSymbol.STYLE_DOT;break;case "dash":a=h.SimpleLineSymbol.STYLE_DASH;break;case "dashdot":a=h.SimpleLineSymbol.STYLE_DASHDOT;break;case "dashdotdot":a=h.SimpleLineSymbol.STYLE_DASHDOTDOT;break;default:a=h.SimpleLineSymbol.STYLE_SOLID}return a},testImageUrl:function(a){var b,c,d=new q,e=d.promise,f=m.create("img");return b=n(f,"load",function(){0===f.width&&0===f.height?d.reject():d.resolve()}),c=n(f,"error",function(){d.reject()}),f.src=a,e.always(function(){b.remove();c.remove();m.destroy(f)}),
e}};return g});