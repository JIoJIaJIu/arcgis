//>>built
define("esri/dijit/geoenrichment/RelatedVariables","../../declare ./BaseSelectComparison ./dom dojo/dom-construct dojo/dom-attr ./lang dojo/i18n!../../nls/jsapi dojo/dom-class dojo/query dojo/string dojo/number ./formatVariable".split(" "),function(x,y,m,u,g,z,e,h,B,v,A,k){e=e.geoenrichment.dijit.RelatedVariables;return x("esri.dijit.geoenrichment.RelatedVariables",y,{baseClass:"Infographics_RelatedVariables",_calculate:function(){for(var a,b,c=Number.NEGATIVE_INFINITY,e=Number.POSITIVE_INFINITY,
d=Number.NEGATIVE_INFINITY,g=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY,k=[],q=this.getDataFields(),n=0;n<q.length;n++){var p,m=this.getFieldByIndex(q[n]),l=this.getValueByName(0,m.name);p=0<=this._state.selectedComparison?A.round(l-this.getValueByName(this._getComparisonRow(),m.name),m.decimals||0):Number.NaN;p>d&&(d=p);g>p&&(g=p);var r=[];r.push(n);r.push(m.alias);r.push(l);r.push(p);k.push(r);l>c&&(c=l,a=q[n]);e>l&&(e=l,b=q[n]);l>f&&(f=l);h>l&&(h=l)}return this._sortRows(k),
{rows:k,indexes:q,minDif:g,maxDif:d,minPct:h,maxPct:f,highCol:a,lowCol:b,lowValue:e,highValue:c}},updateUIExpanded:function(){this.inherited(arguments);var a,b,c=this._calculate(),w=Math.max(Math.abs(c.minDif),Math.abs(c.maxDif));for(b=this.table.rows.length;b<c.indexes.length+1;b++){a=this.table.insertRow(-1);0<b&&0===b%2&&(a.className="AlternatingRow");g.set(a.insertCell(-1),"class","RelatedVariables_TextColumn");g.set(a.insertCell(-1),"class","RelatedVariables_ValueColumn");a.insertCell(-1);var d;
d=a.insertCell(-1);g.set(d,"class","RelatedVariables_ChartNegative");g.set(d,"style","padding: 0;");d=a.insertCell(-1);g.set(d,"class","RelatedVariables_ChartPositive");g.set(d,"style","padding: 0;")}for(;this.table.rows.length>c.indexes.length+1;)this.table.deleteRow(-1);var t,f;for(b=0;b<c.rows.length;b++)f=this.getFieldByIndex(c.indexes[c.rows[b][0]]),a=this.table.rows[b+1],a.cells[0].innerHTML=c.rows[b][1],a.cells[1].innerHTML=k(f,c.rows[b][2]),d=c.rows[b][3],z.isNumber(d)?(f=0<d?"+"+k(f,d):0>
d?"-"+k(f,-d):"0",a.cells[2].innerHTML=f,a.cells[2].className="RelatedVariables_DifferenceColumn",0<d?(h.add(a.cells[2],"RelatedVariables_DifferenceColumn_Positive"),t=m.pct(d/w),a.cells[3].innerHTML="",a.cells[4].innerHTML="\x3cdiv class\x3d'RelatedVariables_PositiveBar' style\x3d'width:"+t+"' /\x3e"):0>d?(h.add(a.cells[2],"RelatedVariables_DifferenceColumn_Negative"),t=m.pct(-d/w),a.cells[3].innerHTML="\x3cdiv class\x3d'RelatedVariables_NegativeBar' style\x3d'width:"+t+"' /\x3e",a.cells[4].innerHTML=
""):(a.cells[3].innerHTML="",a.cells[4].innerHTML="")):(a.cells[2].innerHTML="",a.cells[3].innerHTML="",a.cells[4].innerHTML="");f=this.getFieldByIndex(c.highCol);this.highLabel.innerHTML=v.substitute(e.highLabel2,{alias:f.alias})+" ("+k(f,c.highValue)+")";f=this.getFieldByIndex(c.lowCol);this.lowLabel.innerHTML=v.substitute(e.lowLabel2,{alias:f.alias})+" ("+k(f,c.lowValue)+")"},updateUICollapsed:function(){this.inherited(arguments);var a,b,c=this._calculate();for(b=this.table.rows.length;b<c.indexes.length+
1;b++)a=this.table.insertRow(-1),0<b&&0===b%2&&(a.className="AlternatingRow"),g.set(a.insertCell(-1),"class","RelatedVariables_TextColumn"),g.set(a.insertCell(-1),"class","RelatedVariables_ValueColumn");for(;this.table.rows.length>c.indexes.length+1;)this.table.deleteRow(-1);for(b=0;b<c.rows.length;b++){var e=this.getFieldByIndex(c.indexes[c.rows[b][0]]);a=this.table.rows[b+1];a.cells[0].innerHTML=c.rows[b][1];a.cells[1].innerHTML=k(e,c.rows[b][2]);h.remove(a.cells[1],"MaxPct");h.remove(a.cells[1],
"MinPct");c.rows[b][2]==c.maxPct&&h.add(a.cells[1],"MaxPct");c.rows[b][2]==c.minPct&&h.add(a.cells[1],"MinPct")}},createUIExpanded:function(a){this.inherited(arguments);var b=a.addHeader("div",{"class":"RelatedVariables_Labels"});this.highLabel=u.create("div",{"class":"RelatedVariables_HighLabel"},b);this.lowLabel=u.create("div",{"class":"RelatedVariables_LowLabel"},b);this.table=a.addContent("table",{"class":"RelatedVariables_Table",cellpadding:"2",cellspacing:"0"});m.createCols(this.table,[.35,
.15,.15,.175,.175]);b=this.table.insertRow(0);this._appendSortHeader(b,e.indicatorCol,0,{"class":"RelatedVariables_ColumnHeader"});this._appendSortHeader(b,e.valueCol,2,{"class":"RelatedVariables_ColumnHeader"});this._appendSortHeader(b,e.difCol,3,{"class":"RelatedVariables_ColumnHeader",colspan:"3"});b=a.addFooter("div",{"class":"RelatedVariables_ComparisonDiv"});u.create("div",{"class":"RelatedVariables_ComparisonLabel",innerHTML:e.chartLabel},b);this._createComboBox(b)},createUICollapsed:function(a){this.inherited(arguments);
this.table=a.addContent("table",{"class":"RelatedVariables_Table",cellpadding:"2",cellspacing:"0"});m.createCols(this.table,[.7,.3]);var b=this.table.insertRow(0);this._appendSortHeader(b,e.indicatorCol,0,{"class":"RelatedVariables_ColumnHeader"});this._appendSortHeader(b,e.valueCol,2,{"class":"RelatedVariables_ColumnHeader"})}})});