//>>built
define("esri/renderers/ClassBreaksRenderer","dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer".split(" "),function(m,n,k,r,t,q,p,u){m=m(u,{declaredClass:"esri.renderer.ClassBreaksRenderer",constructor:function(a,c){if(this.breaks=[],this._symbols={},this.infos=[],this.isMaxInclusive=!0,a&&!a.declaredClass){var b=a;this.attributeField=b.field;this.setValueExpression(b.valueExpression);this.defaultSymbol=(a=b.defaultSymbol)&&(a.declaredClass?
a:p.fromJson(a));this.backgroundFillSymbol=(a=b.backgroundFillSymbol)&&(a.declaredClass?a:p.fromJson(a));this._copy(["defaultLabel","classificationMethod:rest","normalizationType:rest","normalizationField","normalizationTotal"],b,this);var d=b.minValue;(b=b.classBreakInfos)&&b[0]&&q.isDefined(b[0].classMaxValue)&&n.forEach(b,function(a){var b=a.classMaxValue;a.minValue=d;d=a.maxValue=b},this);n.forEach(b,this._addBreakInfo,this)}else this.defaultSymbol=a,this.attributeField=c},addBreak:function(a,
c,b){a=k.isObject(a)?a:{minValue:a,maxValue:c,symbol:b};this._addBreakInfo(a)},removeBreak:function(a,c){var b,d,e=this.breaks,h=e.length,l=this._symbols;for(d=0;h>d;d++)if(b=e[d],b[0]==a&&b[1]==c){e.splice(d,1);delete l[a+"-"+c];this.infos.splice(d,1);break}},clearBreaks:function(){this.breaks=[];this._symbols={};this.infos=[]},getBreakIndex:function(a){var c,b,d=this.attributeField;c=a.attributes;var e=this.breaks,h=e.length,l=this.isMaxInclusive;if(this._exprTree)a=this._executeExpr(this._exprTree,
this._createExprContext(a));else if(k.isFunction(d))a=d(a);else{a=parseFloat(c[d]);var f=this.normalizationType;if(f)if(d=parseFloat(this.normalizationTotal),c=parseFloat(c[this.normalizationField]),"log"===f)a=Math.log(a)*Math.LOG10E;else if("percent-of-total"!==f||isNaN(d)){if("field"===f){if(isNaN(a)||isNaN(c))return-1;a/=c}}else a=a/d*100}for(c=0;h>c;c++)if(b=e[c],b[0]<=a&&(l?a<=b[1]:a<b[1]))return c;return-1},getBreakInfo:function(a){a=this.getBreakIndex(a);return-1!==a?this.infos[a]:null},getSymbol:function(a){return(a=
this.breaks[this.getBreakIndex(a)])?this._symbols[a[0]+"-"+a[1]]:this.defaultSymbol},setMaxInclusive:function(a){this.isMaxInclusive=a},setValueExpression:function(a){this.valueExpression=a;this._exprTree=this._parseExpr(a,{vars:{$feature:"any"}})},_normalizationTypeEnums:[["field","esriNormalizeByField"],["log","esriNormalizeByLog"],["percent-of-total","esriNormalizeByPercentOfTotal"]],_classificationMethodEnums:[["natural-breaks","esriClassifyNaturalBreaks"],["equal-interval","esriClassifyEqualInterval"],
["quantile","esriClassifyQuantile"],["standard-deviation","esriClassifyStandardDeviation"],["geometrical-interval","esriClassifyGeometricalInterval"]],_copy:function(a,c,b){n.forEach(a,function(a){var e,h,l,f,g=a.split(":");if(1<g.length&&(a=g[0],e=this["_"+a+"Enums"],"rest"===g[1]?(h="1",l="0"):"sdk"===g[1]&&(h="0",l="1")),f=c[a],void 0!==f&&(b[a]=f,e&&h))for(var k=e.length,g=0;k>g;g++)if(e[g][h]===f){b[a]=e[g][l];break}},this)},_addBreakInfo:function(a){var c=a.minValue,b=a.maxValue;this.breaks.push([c,
b]);this.infos.push(a);var d=a.symbol;d&&(d.declaredClass||(a.symbol=p.fromJson(d)));this._symbols[c+"-"+b]=a.symbol},toJson:function(){var a=this.infos||[],c=q.fixJson,b=a[0]&&a[0].minValue,d=this.backgroundFillSymbol,a=k.mixin(this.inherited(arguments),{type:"classBreaks",field:this.attributeField,valueExpression:this.valueExpression,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),backgroundFillSymbol:d&&d.toJson(),minValue:b===-1/0?-Number.MAX_VALUE:b,classBreakInfos:n.map(a,function(a){return a=
k.mixin({},a),a.symbol=a.symbol&&a.symbol.toJson(),a.classMaxValue=1/0===a.maxValue?Number.MAX_VALUE:a.maxValue,delete a.minValue,delete a.maxValue,c(a)})});return this._copy(["defaultLabel","classificationMethod:sdk","normalizationType:sdk","normalizationField","normalizationTotal"],this,a),a.hasOwnProperty("normalizationType")&&!a.normalizationType&&delete a.normalizationType,a.hasOwnProperty("classificationMethod")&&!a.classificationMethod&&delete a.classificationMethod,c(a)}});return r("extend-esri")&&
k.setObject("renderer.ClassBreaksRenderer",m,t),m});