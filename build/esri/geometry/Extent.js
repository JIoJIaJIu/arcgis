//>>built
define("esri/geometry/Extent","dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils ../srUtils".split(" "),function(y,v,p,z,w,A,x,B,m,r,C,D){var t={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0},h=y(B,{declaredClass:"esri.geometry.Extent",constructor:function(a,b,c,d,e){p.mixin(this,t);p.isObject(a)?(p.mixin(this,a),this.spatialReference&&(this.spatialReference=D.createSpatialReference(this.spatialReference))):
this.update(a,b,c,d,e);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new m((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2,this.spatialReference)},centerAt:function(a){var b=this.getCenter(),c=a.x-b.x;a=a.y-b.y;return new h(this.xmin+c,this.ymin+a,this.xmax+c,this.ymax+a,this.spatialReference)},update:function(a,b,c,d,e){return this.xmin=a,this.ymin=b,this.xmax=c,this.ymax=d,this.spatialReference=
e,this.clearCache(),this},offset:function(a,b){return new h(this.xmin+a,this.ymin+b,this.xmax+a,this.ymax+b,this.spatialReference)},expand:function(a){var b=(1-a)/2;a=this.getWidth()*b;b*=this.getHeight();return new h(this.xmin+a,this.ymin+b,this.xmax-a,this.ymax-b,this.spatialReference)},intersects:function(a){if(!a)return!1;var b=a.type,c=this.spatialReference,d=a.spatialReference;switch(c&&d&&!c.equals(d)&&c._canProject(d)&&(a=c.isWebMercator()?r.geographicToWebMercator(a):r.webMercatorToGeographic(a,
!0)),b){case "point":return this.contains(a);case "multipoint":return this._intersectsMultipoint(a);case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);case "polyline":return this._intersectsPolyline(a)}},normalize:function(){var a=this._normalize(!1,!0);return p.isArray(a)||(a=[a]),a},shiftCentralMeridian:function(){return this._normalize(!0)},_intersectsMultipoint:function(a){var b,c=a.points.length;for(b=0;c>b;b++)if(this.contains(a.getPoint(b)))return!0;
return!1},_intersectsExtent:function(a){var b,c,d,e,f=!1;return this.xmin<=a.xmin?(b=a.xmin,this.xmax<b?f=!0:d=Math.min(this.xmax,a.xmax)-b):(b=this.xmin,a.xmax<b?f=!0:d=Math.min(this.xmax,a.xmax)-b),this.ymin<=a.ymin?(c=a.ymin,this.ymax<c?f=!0:e=Math.min(this.ymax,a.ymax)-c):(c=this.ymin,a.ymax<c?f=!0:e=Math.min(this.ymax,a.ymax)-c),f?null:new h(b,c,b+d,c+e,this.spatialReference)},_intersectsPolygon:function(a){var b,c,d;b=[this.xmin,this.ymax];d=[this.xmax,this.ymax];var e=[this.xmin,this.ymin],
f=[this.xmax,this.ymin],g=[b,d,e,f],e=[[e,b],[b,d],[d,f],[f,e]],f=a.rings,h=f.length,l=new m(0,0,this.spatialReference);d=g.length;for(b=0;d>b;b++)if(l.update(g[b][0],g[b][1]),a.contains(l))return!0;l.setSpatialReference(a.spatialReference);var k,n;for(b=0;h>b;b++)if(c=f[b],d=c.length){if(k=c[0],l.update(k[0],k[1]),this.contains(l))return!0;for(a=1;d>a;a++){if(n=c[a],l.update(n[0],n[1]),this.contains(l)||this._intersectsLine([k,n],e))return!0;k=n}}return!1},_intersectsPolyline:function(a){var b,c,
d,e,f,g=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],h=a.paths,l=h.length,k=new m(0,0,a.spatialReference);for(a=0;l>a;a++)if(c=h[a],d=c.length){if(e=c[0],k.update(e[0],e[1]),this.contains(k))return!0;for(b=1;d>b;b++){if(f=c[b],k.update(f[0],f[1]),this.contains(k)||this._intersectsLine([e,f],g))return!0;e=f}}return!1},_intersectsLine:function(a,b){var c,d=C._getLineIntersection2,
e=b.length;for(c=0;e>c;c++)if(d(a,b[c]))return!0;return!1},contains:function(a){if(!a)return!1;var b=a.type;if("point"===b){var c,b=this.spatialReference,d=a.spatialReference,e=a.x;a=a.y;return b&&d&&!b.equals(d)&&b._canProject(d)&&(c=b.isWebMercator()?m.lngLatToXY(e,a):m.xyToLngLat(e,a,!0),e=c[0],a=c[1]),e>=this.xmin&&e<=this.xmax&&a>=this.ymin&&a<=this.ymax}return"extent"===b?this._containsExtent(a):!1},_containsExtent:function(a){var b=a.xmin,c=a.ymin,d=a.xmax,e=a.ymax,f=a.spatialReference;a=new m(b,
c,f);b=new m(b,e,f);e=new m(d,e,f);c=new m(d,c,f);return this.contains(a)&&this.contains(b)&&this.contains(e)&&this.contains(c)?!0:!1},union:function(a){return new h(Math.min(this.xmin,a.xmin),Math.min(this.ymin,a.ymin),Math.max(this.xmax,a.xmax),Math.max(this.ymax,a.ymax),this.spatialReference)},getExtent:function(){var a=this.spatialReference;return new h(this.xmin,this.ymin,this.xmax,this.ymax,a&&new x(a.toJson()))},_shiftCM:function(a){var b=this.getCacheValue("_shifted");if(!b){var b=new h(this.toJson()),
c=b.spatialReference;if(a=a||c._getInfo()){var d=this._getCM(a);if(d){var e=c._isWebMercator()?r.webMercatorToGeographic(d):d;b.xmin-=d.x;b.xmax-=d.x;c._isWebMercator()||(e.x=this._normalizeX(e.x,a).x);b.setSpatialReference(new x(A.substitute({Central_Meridian:e.x},4326===c.wkid?a.altTemplate:a.wkTemplate)))}}this.setCacheValue("_shifted",b)}return b},_getCM:function(a){var b,c=a.valid[0];a=a.valid[1];var d=this.xmin,e=this.xmax;return d>=c&&a>=d&&e>=c&&a>=e||(b=this.getCenter()),b},_normalize:function(a,
b,c){var d=new h(this.toJson()),e=d.spatialReference;if(e&&(c=c||e._getInfo())){var f=v.map(this._getParts(c),function(a){return a.extent});return 2<f.length?a?this._shiftCM(c):d.update(c.valid[0],d.ymin,c.valid[1],d.ymax,e):2===f.length?a?this._shiftCM(c):b?f:{rings:v.map(f,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:e}:f[0]||d}return d},_getParts:function(a){var b=this.getCacheValue("_parts");if(!b){var b=[],c,d,e,f,g=this.xmin,
m=this.xmax,l=this.ymin,k=this.ymax,n=this.spatialReference,p=this.getWidth(),r=g,t=m,q=0,u=0;if(a=a||n._getInfo(),d=a.valid[0],e=a.valid[1],c=this._normalizeX(g,a),g=c.x,q=c.frameId,c=this._normalizeX(m,a),m=c.x,u=c.frameId,f=g===m&&0<p,p>2*e){a=new h(t>r?g:m,l,e,k,n);g=new h(d,l,t>r?m:g,k,n);e=new h(0,l,e,k,n);l=new h(d,l,0,k,n);k=[];n=[];a.contains(e)&&k.push(q);a.contains(l)&&n.push(q);g.contains(e)&&k.push(u);g.contains(l)&&n.push(u);for(d=q+1;u>d;d++)k.push(d),n.push(d);b.push({extent:a,frameIds:[q]},
{extent:g,frameIds:[u]},{extent:e,frameIds:k},{extent:l,frameIds:n})}else g>m||f?b.push({extent:new h(g,l,e,k,n),frameIds:[q]},{extent:new h(d,l,m,k,n),frameIds:[u]}):b.push({extent:new h(g,l,m,k,n),frameIds:[q]});this.setCacheValue("_parts",b)}return b},_normalizeX:function(a,b){var c,d=0,e=b.valid[0],f=b.valid[1],g=2*f;return a>f?(c=Math.ceil(Math.abs(a-f)/g),a-=c*g,d=c):e>a&&(c=Math.ceil(Math.abs(a-e)/g),a+=c*g,d=-c),{x:a,frameId:d}},toJson:function(){var a={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,
ymax:this.ymax},b=this.spatialReference;return b&&(a.spatialReference=b.toJson()),a}});return h.defaultProps=t,z("extend-esri")&&(p.setObject("geometry.Extent",h,w),w.geometry.defaultExtent=t),h});