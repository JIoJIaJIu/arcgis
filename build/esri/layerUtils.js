//>>built
define("esri/layerUtils",["dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/has","./kernel"],function(m,g,k,n,p){var l={_serializeLayerDefinitions:function(a){var b=[],d=!1,e=/[:;]/;if(a&&(g.forEach(a,function(a,c){a&&(b.push([c,a]),!d&&e.test(a)&&(d=!0))}),0<b.length)){var c;return d?(c={},g.forEach(b,function(a){c[a[0]]=a[1]}),c=k.toJson(c)):(c=[],g.forEach(b,function(a){c.push(a[0]+":"+a[1])}),c=c.join(";")),c}return null},_serializeTimeOptions:function(a,b){if(a){var d=[];return g.forEach(a,
function(a,c){if(a){var f=a.toJson();b&&-1!==g.indexOf(b,c)&&(f.useTime=!1);d.push('"'+c+'":'+k.toJson(f))}}),d.length?"{"+d.join(",")+"}":void 0}},_getVisibleLayers:function(a,b){var d,e,c,f=[];if(!a)return f;if(b)for(f=b.concat(),c=0;c<a.length;c++)d=a[c],e=g.indexOf(a,d.id),d.subLayerIds&&-1<e&&(f.splice(e,1),f=f.concat(d.subLayerIds));else f=this._getDefaultVisibleLayers(a);return f},_getDefaultVisibleLayers:function(a){var b,d=[];if(!a)return d;for(b=0;b<a.length;b++)0<=a[b].parentLayerId&&-1===
g.indexOf(d,a[b].parentLayerId)&&g.some(a,function(d){return d.id===a[b].parentLayerId})||a[b].defaultVisibility&&d.push(a[b].id);return d},_getLayersForScale:function(a,b){var d=[];if(0<a&&b){var e;for(e=0;e<b.length;e++)if(!(0<=b[e].parentLayerId&&-1===g.indexOf(d,b[e].parentLayerId)&&g.some(b,function(a){return a.id===b[e].parentLayerId}))&&0<=b[e].id){var c=!0,f=b[e].maxScale,h=b[e].minScale;(0<f||0<h)&&(0<f&&0<h?c=a>=f&&h>=a:0<f?c=a>=f:0<h&&(c=h>=a));c&&d.push(b[e].id)}}return d}};return n("extend-esri")&&
m.mixin(p,l),l});