//>>built
/*
 MIT License <http://www.opensource.org/licenses/mit-license.php>
*/
!function(){function p(b,f,g){this.obj=b;this.right=this.left=null;this.parent=g;this.dimension=f}function t(b,f,g){function e(a,k,u){var b,c,h=k%g.length;return 0===a.length?null:1===a.length?new p(a[0],h,u):(a.sort(function(a,c){return a[g[h]]-c[g[h]]}),b=Math.floor(a.length/2),c=new p(a[b],h,u),c.left=e(a.slice(0,b),k+1,c),c.right=e(a.slice(b+1),k+1,c),c)}function n(a){function k(a){a.left&&(a.left.parent=a,k(a.left));a.right&&(a.right.parent=a,k(a.right))}l.root=a;k(l.root)}var l=this;Array.isArray(b)?
this.root=e(b,0,null):n(b,f,g);this.toJSON=function(a){a||(a=this.root);var k=new p(a.obj,a.dimension,null);return a.left&&(k.left=l.toJSON(a.left)),a.right&&(k.right=l.toJSON(a.right)),k};this.insert=function(a){function k(c,b){if(null===c)return b;var d=g[c.dimension];return a[d]<c.obj[d]?k(c.left,c):k(c.right,c)}var b,f,c=k(this.root,null);return null===c?void(this.root=new p(a,0,null)):(b=new p(a,(c.dimension+1)%g.length,c),f=g[c.dimension],void(a[f]<c.obj[f]?c.left=b:c.right=b))};this.remove=
function(a){function b(c){if(null===c)return null;if(c.obj===a)return c;var h=g[c.dimension];return a[h]<c.obj[h]?b(c.left,c):b(c.right,c)}function f(a){function b(a,c){var k,d,f,e,m;return null===a?null:(k=g[c],a.dimension===c?null!==a.right?b(a.right,c):a:(d=a.obj[k],f=b(a.left,c),e=b(a.right,c),m=a,null!==f&&f.obj[k]>d&&(m=f),null!==e&&e.obj[k]>m.obj[k]&&(m=e),m))}function k(a,b){var c,d,f,e,h;return null===a?null:(c=g[b],a.dimension===b?null!==a.left?k(a.left,b):a:(d=a.obj[c],f=k(a.left,b),e=
k(a.right,b),h=a,null!==f&&f.obj[c]<d&&(h=f),null!==e&&e.obj[c]<h.obj[c]&&(h=e),h))}var d,e,r;return null===a.left&&null===a.right?null===a.parent?void(l.root=null):(r=g[a.parent.dimension],void(a.obj[r]<a.parent.obj[r]?a.parent.left=null:a.parent.right=null)):(d=null!==a.left?b(a.left,a.dimension):k(a.right,a.dimension),e=d.obj,f(d),void(a.obj=e))}var e;e=b(l.root);null!==e&&f(e)};this.nearest=function(a,b,e,n){function c(d){var h,l,n;h=g[d.dimension];var p=f(a,d.obj),q={};for(l=0;l<g.length;l+=
1)q[g[l]]=l===d.dimension?a[g[l]]:d.obj[g[l]];l=f(q,d.obj);null===d.right&&null===d.left?(!(m.size()<b||p<m.peek()[1])||e&&!e(d.obj)||(m.push([d,p]),m.size()>b&&m.pop()),d=void 0):(h=null===d.right?d.left:null===d.left?d.right:a[h]<d.obj[h]?d.left:d.right,c(h),!(m.size()<b||p<m.peek()[1])||e&&!e(d.obj)||(m.push([d,p]),m.size()>b&&m.pop()),d=void((m.size()<b||Math.abs(l)<m.peek()[1])&&(n=h===d.left?d.right:d.left,null!==n&&c(n))));return d}var h,m;if(m=new q(function(a){return-a[1]}),n)for(h=0;b>h;h+=
1)m.push([null,n]);c(l.root);n=[];for(h=0;b>h&&h<m.content.length;h+=1)m.content[h][0]&&n.push([m.content[h][0].obj,m.content[h][1]]);return n};this.balanceFactor=function(){function a(b){return null===b?0:Math.max(a(b.left),a(b.right))+1}function b(a){return null===a?0:b(a.left)+b(a.right)+1}return a(l.root)/(Math.log(b(l.root))/Math.log(2))}}function q(b){this.content=[];this.scoreFunction=b}q.prototype={push:function(b){this.content.push(b);this.bubbleUp(this.content.length-1)},pop:function(){var b=
this.content[0],f=this.content.pop();return 0<this.content.length&&(this.content[0]=f,this.sinkDown(0)),b},peek:function(){return this.content[0]},remove:function(b){for(var f=this.content.length,g=0;f>g;g++)if(this.content[g]==b){var e=this.content.pop();return void(g!=f-1&&(this.content[g]=e,this.scoreFunction(e)<this.scoreFunction(b)?this.bubbleUp(g):this.sinkDown(g)))}throw Error("Node not found.");},size:function(){return this.content.length},bubbleUp:function(b){for(var f=this.content[b];0<
b;){var g=Math.floor((b+1)/2)-1,e=this.content[g];if(!(this.scoreFunction(f)<this.scoreFunction(e)))break;this.content[g]=f;this.content[b]=e;b=g}},sinkDown:function(b){for(var f=this.content.length,g=this.content[b],e=this.scoreFunction(g);;){var n=2*(b+1),l=n-1,a=null;if(f>l){var k=this.scoreFunction(this.content[l]);e>k&&(a=l)}f>n&&(l=this.scoreFunction(this.content[n]),(null==a?e:k)>l&&(a=n));if(null==a)break;this.content[b]=this.content[a];this.content[a]=g;b=a}}};this.kdTree=t;"undefined"!=
typeof exports&&(exports.kdTree=t,exports.BinaryHeap=q)}();